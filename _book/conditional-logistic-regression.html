<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Conditional Logistic Regression | Stats For You</title>
  <meta name="description" content="<p>This book provides an introduction to various topics in statistics and
probability.</p>" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Conditional Logistic Regression | Stats For You" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This book provides an introduction to various topics in statistics and
probability.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Conditional Logistic Regression | Stats For You" />
  
  <meta name="twitter:description" content="<p>This book provides an introduction to various topics in statistics and
probability.</p>" />
  

<meta name="author" content="Frederick De Baene" />


<meta name="date" content="2025-11-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="logistic-models-and-deviance.html"/>
<link rel="next" href="missingness.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Stats For You</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a></li>
<li class="chapter" data-level="2" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html"><i class="fa fa-check"></i><b>2</b> Logistic Models and Deviance</a>
<ul>
<li class="chapter" data-level="2.1" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#models"><i class="fa fa-check"></i><b>2.1</b> Models</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#proposed-model"><i class="fa fa-check"></i><b>2.1.1</b> Proposed Model</a></li>
<li class="chapter" data-level="2.1.2" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#null-model"><i class="fa fa-check"></i><b>2.1.2</b> Null Model</a></li>
<li class="chapter" data-level="2.1.3" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#saturated-model"><i class="fa fa-check"></i><b>2.1.3</b> Saturated Model</a></li>
<li class="chapter" data-level="2.1.4" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#models-and-deviance"><i class="fa fa-check"></i><b>2.1.4</b> Models and Deviance</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#likelihood-and-log-likelihood"><i class="fa fa-check"></i><b>2.2</b> Likelihood and Log-Likelihood</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#proposed-model-1"><i class="fa fa-check"></i><b>2.2.1</b> Proposed Model</a></li>
<li class="chapter" data-level="2.2.2" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#null-model-1"><i class="fa fa-check"></i><b>2.2.2</b> Null Model</a></li>
<li class="chapter" data-level="2.2.3" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#saturated-model-1"><i class="fa fa-check"></i><b>2.2.3</b> Saturated Model</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#deviance"><i class="fa fa-check"></i><b>2.3</b> Deviance</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="conditional-logistic-regression.html"><a href="conditional-logistic-regression.html"><i class="fa fa-check"></i><b>3</b> Conditional Logistic Regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="conditional-logistic-regression.html"><a href="conditional-logistic-regression.html#definition"><i class="fa fa-check"></i><b>3.1</b> Definition</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="missingness.html"><a href="missingness.html"><i class="fa fa-check"></i><b>4</b> Missingness</a>
<ul>
<li class="chapter" data-level="4.1" data-path="missingness.html"><a href="missingness.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="missingness.html"><a href="missingness.html#missingess-patterns"><i class="fa fa-check"></i><b>4.2</b> Missingess Patterns</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="missingness.html"><a href="missingness.html#simulation-setup"><i class="fa fa-check"></i><b>4.2.1</b> Simulation Setup</a></li>
<li class="chapter" data-level="4.2.2" data-path="missingness.html"><a href="missingness.html#missingness-completely-at-random"><i class="fa fa-check"></i><b>4.2.2</b> Missingness Completely at Random</a></li>
<li class="chapter" data-level="4.2.3" data-path="missingness.html"><a href="missingness.html#missingness-at-random"><i class="fa fa-check"></i><b>4.2.3</b> Missingness at Random</a></li>
<li class="chapter" data-level="4.2.4" data-path="missingness.html"><a href="missingness.html#missingness-not-at-random"><i class="fa fa-check"></i><b>4.2.4</b> Missingness Not at Random</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stats For You</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="conditional-logistic-regression" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Conditional Logistic Regression<a href="conditional-logistic-regression.html#conditional-logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this chapter, we explore <strong>conditional</strong> logistic regression. Conditional
logistic regression allows us to not have to estimate nuisance parameters. We
will illustrate this with an example. Suppose we have a dataset comprising data
on 20 patients distributed across two hospitals (with 10 patients each). For
each patient, we know what hospital they were admitted to, their age at the time
of hospital admission, and if they survived their hospital stay.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="conditional-logistic-regression.html#cb1-1" tabindex="-1"></a><span class="co"># Create the dataset</span></span>
<span id="cb1-2"><a href="conditional-logistic-regression.html#cb1-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">345</span>)</span>
<span id="cb1-3"><a href="conditional-logistic-regression.html#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="conditional-logistic-regression.html#cb1-4" tabindex="-1"></a>df <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb1-5"><a href="conditional-logistic-regression.html#cb1-5" tabindex="-1"></a>  <span class="at">i =</span> <span class="dv">1</span><span class="dt">L</span><span class="sc">:</span><span class="dv">20</span><span class="dt">L</span>,</span>
<span id="cb1-6"><a href="conditional-logistic-regression.html#cb1-6" tabindex="-1"></a>  <span class="at">hospital =</span> <span class="fu">factor</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="at">each =</span> <span class="dv">10</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>)),</span>
<span id="cb1-7"><a href="conditional-logistic-regression.html#cb1-7" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">c</span>(<span class="dv">65</span>, <span class="dv">70</span>, <span class="dv">75</span>, <span class="dv">60</span>, <span class="dv">68</span>, <span class="dv">72</span>, <span class="dv">80</span>, <span class="dv">78</span>, <span class="dv">85</span>, <span class="dv">76</span>, <span class="dv">55</span>, <span class="dv">60</span>, <span class="dv">65</span>, <span class="dv">70</span>, <span class="dv">75</span>, <span class="dv">80</span>, <span class="dv">85</span>, <span class="dv">90</span>, <span class="dv">72</span>, <span class="dv">78</span>),</span>
<span id="cb1-8"><a href="conditional-logistic-regression.html#cb1-8" tabindex="-1"></a>  <span class="at">Y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1-9"><a href="conditional-logistic-regression.html#cb1-9" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 20 × 4
##        i hospital   age     Y
##    &lt;int&gt; &lt;fct&gt;    &lt;dbl&gt; &lt;dbl&gt;
##  1     1 A           65     1
##  2     2 A           70     0
##  3     3 A           75     1
##  4     4 A           60     0
##  5     5 A           68     1
##  6     6 A           72     0
##  7     7 A           80     0
##  8     8 A           78     0
##  9     9 A           85     0
## 10    10 A           76     0
## 11    11 B           55     1
## 12    12 B           60     1
## 13    13 B           65     1
## 14    14 B           70     0
## 15    15 B           75     1
## 16    16 B           80     1
## 17    17 B           85     0
## 18    18 B           90     1
## 19    19 B           72     0
## 20    20 B           78     1</code></pre>
<div id="definition" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Definition<a href="conditional-logistic-regression.html#definition" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let <span class="math inline">\(Y_i\)</span> denote the outcome for patient <span class="math inline">\(i\)</span>, with <span class="math inline">\(Y_i = 1\)</span> if patient <span class="math inline">\(i\)</span> died
and <span class="math inline">\(Y_i = 0\)</span> otherwise. Let <span class="math inline">\(X_i\)</span> denote the age of patient <span class="math inline">\(i\)</span> at the time of
hospital admission. Let <span class="math inline">\(Z_i\)</span> denote the hospital at which patient <span class="math inline">\(i\)</span> was
admitted, with <span class="math inline">\(Z_i = 0\)</span> if patient <span class="math inline">\(i\)</span> was admitted to hospital A and <span class="math inline">\(Z_i = 1\)</span>
otherwise. We can now calculate the probability of patient <span class="math inline">\(i\)</span> dying conditional
on their age and the hospital where they were admitted to as:</p>
<p><span class="math display">\[
\mathbb{P} (Y_i = 1) = \frac{exp(\beta_z \cdot z_i + \beta_x \cdot x_i)}{1 + exp(\beta_z \cdot z_i + \beta_x \cdot x_i)}
\]</span></p>
<p>We know that <span class="math inline">\(\beta_z = 0.24\)</span> and <span class="math inline">\(\beta_x = 0.5\)</span>. We can now calculate the
probability of dying for each patient.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="conditional-logistic-regression.html#cb3-1" tabindex="-1"></a><span class="co"># Define the parameters</span></span>
<span id="cb3-2"><a href="conditional-logistic-regression.html#cb3-2" tabindex="-1"></a>B_z <span class="ot">&lt;-</span> <span class="fl">1.85</span></span>
<span id="cb3-3"><a href="conditional-logistic-regression.html#cb3-3" tabindex="-1"></a>B_x <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb3-4"><a href="conditional-logistic-regression.html#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="conditional-logistic-regression.html#cb3-5" tabindex="-1"></a><span class="co"># Calculate the probability of dying per patient</span></span>
<span id="cb3-6"><a href="conditional-logistic-regression.html#cb3-6" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="conditional-logistic-regression.html#cb3-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="conditional-logistic-regression.html#cb3-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Z_i =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(hospital <span class="sc">==</span> <span class="st">&quot;A&quot;</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">X_i =</span> age) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="conditional-logistic-regression.html#cb3-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">P_i =</span> <span class="fu">exp</span>(Z_i <span class="sc">*</span> B_z <span class="sc">+</span> X_i <span class="sc">*</span> B_x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(Z_i <span class="sc">*</span> B_z <span class="sc">+</span> X_i <span class="sc">*</span> B_x)))</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="conditional-logistic-regression.html#cb4-1" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 20 × 7
## # Rowwise: 
##        i hospital   age     Y   Z_i   X_i   P_i
##    &lt;int&gt; &lt;fct&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     1 A           65     1     0    65 0.963
##  2     2 A           70     0     0    70 0.971
##  3     3 A           75     1     0    75 0.977
##  4     4 A           60     0     0    60 0.953
##  5     5 A           68     1     0    68 0.968
##  6     6 A           72     0     0    72 0.973
##  7     7 A           80     0     0    80 0.982
##  8     8 A           78     0     0    78 0.980
##  9     9 A           85     0     0    85 0.986
## 10    10 A           76     0     0    76 0.978
## 11    11 B           55     1     1    55 0.990
## 12    12 B           60     1     1    60 0.992
## 13    13 B           65     1     1    65 0.994
## 14    14 B           70     0     1    70 0.995
## 15    15 B           75     1     1    75 0.996
## 16    16 B           80     1     1    80 0.997
## 17    17 B           85     0     1    85 0.998
## 18    18 B           90     1     1    90 0.998
## 19    19 B           72     0     1    72 0.996
## 20    20 B           78     1     1    78 0.997</code></pre>
<p>If we want to know what the probability of a particular outcome in a hospital is
for all ten patients, we have the following:</p>
<p><span class="math display">\[
\mathbb{P} (Y_1 = y_1, Y_2 = y_2, ..., Y_n = Y_n) = \frac{exp(\beta_z \cdot z_i + \beta_x \cdot x_i)}{1 + exp(\beta_z \cdot z_i + \beta_x \cdot x_i)}
\]</span></p>
<p>Now, suppose we are only interested in <span class="math inline">\(\beta_x\)</span> and not in <span class="math inline">\(\beta_z\)</span>, the
latter being a nuisance parameter. We would like to eliminate <span class="math inline">\(\beta_z\)</span> from
the estimation. We can do this by conditioning the likelihood function. This
results in an estimate only for age <span class="math inline">\(X_i\)</span>. Within each hospital, we want to
calculate the probability of obtaining a particular outcome, e.g., 3 out of
10 patients died.</p>
<p>Let us look at our two hospitals and the outcomes. We can then see that 3 out of
10 patients died in hospital A and 7 out of 10 patients in hospital B.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="conditional-logistic-regression.html#cb6-1" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>hospital, df<span class="sc">$</span>Y)</span></code></pre></div>
<pre><code>##    
##     0 1
##   A 7 3
##   B 3 7</code></pre>
<p>We can calculate the probability of this outcome for each hospital. To calculate
the probability of a single patient dying, we have:</p>
<p><span class="math display">\[
\mathbb{P} (Y_i = 1) = \frac{exp(\beta_z z_i + \beta_x x_i)}{1 + exp(\beta_z z_i + \beta_x x_i)}
\]</span></p>
<p>Or if we do not know what the outcome is but we want to calculate the
probability of that outcome:</p>
<p><span class="math display">\[
\mathbb{P} (Y_i = y_i) = \frac{exp(y_i \cdot (\beta_z z_i + \beta_x x_i))}{1 + exp(\beta_z z_i + \beta_x x_i)}
\]</span></p>
<p>We have ten patients per hospital. If we want to calculate the probability of a
particular outcome occurring, we have:</p>
<p><span class="math display">\[
\begin{align}
\mathbb{P} (Y_1 = y_1, ..., Y_n = y_n)
  &amp;= \prod_{i = 1}^{n} \frac{exp(y_i \cdot (\beta_z z_i + \beta_x x_i))}{1 + exp(\beta_z z_i + \beta_x x_i)} \\
  &amp;= \frac{\prod_{i = 1}^{n} exp(y_i \cdot (\beta_z z_i + \beta_x x_i))}{\prod_{i = 1}^{n} [1 + exp(\beta_z z_i + \beta_x x_i)]} \\
  &amp;= \frac{\prod_{i = 1}^{n} exp(y_i \beta_z z_i + y_i \beta_x x_i))}{\prod_{i = 1}^{n} [1 + exp(\beta_z z_i + \beta_x x_i)]} \\
  &amp;= \frac{exp(\sum_{i = 1}^{n} y_i \beta_z z_i + \sum_{i = 1}^{n} y_i \beta_x x_i))}{\prod_{i = 1}^{n} [1 + exp(\beta_z z_i + \beta_x x_i)]} \\
  &amp;= \frac{exp(\beta_z \sum_{i = 1}^{n} y_i z_i + \beta_x \sum_{i = 1}^{n} y_i x_i))}{\prod_{i = 1}^{n} [1 + exp(\beta_z z_i + \beta_x x_i)]}
\end{align}
\]</span></p>
<p>We can now calculate the probability of the outcome <span class="math inline">\(Y_1 = 1\)</span>, <span class="math inline">\(Y_3 = 1\)</span>, and
<span class="math inline">\(Y_8 = 1\)</span> in hospital A occurring. Note that we specify three particular
patients that have died. But if we are only interested in 3 out of 10 patients
dying in hospital A. In that case, there are <span class="math inline">\({10 \choose 3} = 120\)</span> outcomes of
interest. First, we define this set of 120 outcomes:</p>
<p><span class="math display">\[
S(t) = \{ (Y_1 = y_1, Y_2, = y_2, ..., Y_n = y_n) | \sum_{i = 1}^{n} y_i = t \}
\]</span></p>
<p>To calculate the probability of <span class="math inline">\(S(t)\)</span> occurring, we can calculate this as
follows:</p>
<p><span class="math display">\[
\begin{align}
\mathbb{P} (S(t))
  &amp;= \sum_{S(t)} \mathbb{P} (Y_1 = y_i, ..., Y_n = y_n) \\
  &amp;= \sum_{S(t)} [\frac{exp(\beta_z \sum_{i = 1}^{n} y_i z_i + \beta_x \sum_{i = 1}^{n} y_i x_i))}{\prod_{i = 1}^{n} [1 + exp(\beta_z z_i + \beta_x x_i)]}] \\
  &amp;= \frac{1}{\prod_{i = 1}^{n} [1 + exp(\beta_z z_i + \beta_x x_i)]} \cdot \sum_{S(t)} [exp(\beta_z \sum_{i = 1}^{n} y_i z_i + \beta_x \sum_{i = 1}^{n} y_i x_i))]
\end{align}
\]</span></p>
<p>We can now calculate the conditional probability of the outcome <span class="math inline">\(Y_1 = 1\)</span>,
<span class="math inline">\(Y_3 = 1\)</span>, and <span class="math inline">\(Y_8\)</span> conditional on that 3 out of 10 patients died in hospital A.</p>
<p><span class="math display">\[
\begin{align}
\mathbb{P} (Y_1 = 0, Y_2 = 0, Y_3 = 1, ..., Y_{10} = 0 | \sum_{i} y_i = 10)
  &amp;= \frac{\mathbb{P} (Y_1 = y_1, ..., Y_{10} = y_{10})}{\mathbb{P} (S(t = 3))} \\
  &amp;= \frac{\frac{exp(\beta_z \sum_{i = 1}^{n} y_i z_i + \beta_x \sum_{i = 1}^{n} y_i x_i)}{\prod_{i = 1}^{n} [1 + exp(\beta_z z_i + \beta_x x_i)]}}{\frac{1}{\prod_{i = 1}^{n} [1 + exp(\beta_z z_i + \beta_x x_i)]} \cdot \sum_{S(t)} [exp(\beta_z \sum_{i = 1}^{n} y_i z_i + \beta_x \sum_{i = 1}^{n} y_i x_i))]} \\
  &amp;= \frac{exp(\beta_z \sum_{i = 1}^{n} y_i z_i + \beta_x \sum_{i = 1}^{n} y_i x_i)}{\sum_{S(t)} [exp(\beta_z \sum_{i = 1}^{n} y_i z_i + \beta_x \sum_{i = 1}^{n} y_i x_i)]}
\end{align}
\]</span></p>
<p>Because we look at each hospital individually, we know what the value is for
<span class="math inline">\(z_i\)</span> for each patient. If we look at hospital B, we know that <span class="math inline">\(z_i = 1\)</span> for
<span class="math inline">\(i = 1, ..., 10\)</span>. In that case, we have:</p>
<p><span class="math display">\[
\begin{align}
\mathbb{P} (Y_1 = 0, Y_2 = 0, Y_3 = 1, ..., Y_{10} = 0 | \sum_{i} y_i = 10)
  &amp;= \frac{exp(\beta_z \sum_{i = 1}^{n} y_i z_i + \beta_x \sum_{i = 1}^{n} y_i x_i)}{\sum_{S(t)} [exp(\beta_z \sum_{i = 1}^{n} y_i z_i + \beta_x \sum_{i = 1}^{n} y_i x_i)]} \\
  &amp;= \frac{exp(\beta_z \sum_{i = 1}^{n} y_i + \beta_x \sum_{i = 1}^{n} y_i x_i)}{\sum_{S(t)} [exp(\beta_z \sum_{i = 1}^{n} y_i + \beta_x \sum_{i = 1}^{n} y_i x_i)]} \\
  &amp;= \frac{exp(\beta_z t + \beta_x \sum_{i = 1}^{n} y_i x_i)}{\sum_{S(t)} [exp(\beta_z t + \beta_x \sum_{i = 1}^{n} y_i x_i)]} \\
  &amp;= \frac{exp(\beta_z t) exp(\beta_x \sum_{i = 1}^{n} y_i x_i)}{\sum_{S(t)} [exp(\beta_z t) exp(\beta_x \sum_{i = 1}^{n} y_i x_i)]} \\
  &amp;= \frac{exp(\beta_z t) exp(\beta_x \sum_{i = 1}^{n} y_i x_i)}{exp(\beta_z t) \sum_{S(t)} [exp(\beta_x \sum_{i = 1}^{n} y_i x_i)]} \\
  &amp;= \frac{exp(\beta_x \sum_{i = 1}^{n} y_i x_i)}{\sum_{S(t)} [exp(\beta_x \sum_{i = 1}^{n} y_i x_i)]}
\end{align}
\]</span></p>
<p>This is the conditional probability. We can use this to determine the
conditional likelihood and log-likelihood, in which we do not have to estimate
the nuisance paramter <span class="math inline">\(\beta_z\)</span>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="logistic-models-and-deviance.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="missingness.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/03-conditional-logistic-regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
