<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Validation | Stats For You</title>
  <meta name="description" content="<p>This book provides an introduction to various topics in statistics and
probability.</p>" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Validation | Stats For You" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This book provides an introduction to various topics in statistics and
probability.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Validation | Stats For You" />
  
  <meta name="twitter:description" content="<p>This book provides an introduction to various topics in statistics and
probability.</p>" />
  

<meta name="author" content="Frederick De Baene" />


<meta name="date" content="2025-02-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="logistic-models-and-deviance.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Stats For You</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a></li>
<li class="chapter" data-level="2" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html"><i class="fa fa-check"></i><b>2</b> Logistic Models and Deviance</a>
<ul>
<li class="chapter" data-level="2.1" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#models"><i class="fa fa-check"></i><b>2.1</b> Models</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#proposed-model"><i class="fa fa-check"></i><b>2.1.1</b> Proposed Model</a></li>
<li class="chapter" data-level="2.1.2" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#null-model"><i class="fa fa-check"></i><b>2.1.2</b> Null Model</a></li>
<li class="chapter" data-level="2.1.3" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#saturated-model"><i class="fa fa-check"></i><b>2.1.3</b> Saturated Model</a></li>
<li class="chapter" data-level="2.1.4" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#models-and-deviance"><i class="fa fa-check"></i><b>2.1.4</b> Models and Deviance</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#likelihood-and-log-likelihood"><i class="fa fa-check"></i><b>2.2</b> Likelihood and Log-Likelihood</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#proposed-model-1"><i class="fa fa-check"></i><b>2.2.1</b> Proposed Model</a></li>
<li class="chapter" data-level="2.2.2" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#null-model-1"><i class="fa fa-check"></i><b>2.2.2</b> Null Model</a></li>
<li class="chapter" data-level="2.2.3" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#saturated-model-1"><i class="fa fa-check"></i><b>2.2.3</b> Saturated Model</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#deviance"><i class="fa fa-check"></i><b>2.3</b> Deviance</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="validation.html"><a href="validation.html"><i class="fa fa-check"></i><b>3</b> Validation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="validation.html"><a href="validation.html#validation-set-approach"><i class="fa fa-check"></i><b>3.1</b> Validation Set Approach</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="validation.html"><a href="validation.html#variability-of-mse"><i class="fa fa-check"></i><b>3.1.1</b> Variability of MSE</a></li>
<li class="chapter" data-level="3.1.2" data-path="validation.html"><a href="validation.html#training-set-size"><i class="fa fa-check"></i><b>3.1.2</b> Training Set Size</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="validation.html"><a href="validation.html#leave-one-out-cross-validation"><i class="fa fa-check"></i><b>3.2</b> Leave-One-Out Cross-Validation</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="validation.html"><a href="validation.html#variability-of-mse-1"><i class="fa fa-check"></i><b>3.2.1</b> Variability of MSE</a></li>
<li class="chapter" data-level="3.2.2" data-path="validation.html"><a href="validation.html#training-set-size-1"><i class="fa fa-check"></i><b>3.2.2</b> Training Set Size</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stats For You</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="validation" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Validation<a href="validation.html#validation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>We use the brains data set sourced from:</p>
<p><a href="Kaggle">https://www.kaggle.com/datasets/anubhabswain/brain-weight-in-humans</a></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="validation.html#cb1-1" tabindex="-1"></a><span class="co"># Read the data set into R</span></span>
<span id="cb1-2"><a href="validation.html#cb1-2" tabindex="-1"></a>brains <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(</span>
<span id="cb1-3"><a href="validation.html#cb1-3" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;data/brains.csv&quot;</span>,</span>
<span id="cb1-4"><a href="validation.html#cb1-4" tabindex="-1"></a>  <span class="at">show_col_types =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-5"><a href="validation.html#cb1-5" tabindex="-1"></a>  <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">&quot;sex&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;head_volume&quot;</span>, <span class="st">&quot;brain_weight&quot;</span>),</span>
<span id="cb1-6"><a href="validation.html#cb1-6" tabindex="-1"></a>  <span class="at">skip =</span> <span class="dv">1</span></span>
<span id="cb1-7"><a href="validation.html#cb1-7" tabindex="-1"></a>)</span>
<span id="cb1-8"><a href="validation.html#cb1-8" tabindex="-1"></a></span>
<span id="cb1-9"><a href="validation.html#cb1-9" tabindex="-1"></a><span class="co"># Get the sample size</span></span>
<span id="cb1-10"><a href="validation.html#cb1-10" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(brains)</span></code></pre></div>
<p>The coding is as follows:</p>
<ul>
<li><code>sex</code>: 1 = male, 2 = female</li>
<li><code>age</code>: 1 = older than 18 years, 2 = younger than 18 years</li>
<li><code>head_volume</code>: volume of the head in cubic centimeters</li>
<li><code>brain_weight</code>: weight of the brain in grams.</li>
</ul>
<div id="validation-set-approach" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Validation Set Approach<a href="validation.html#validation-set-approach" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The complete set of observations is randomly split into two parts: a training
set and a validation set (test set, hold-out set). The model is fit to the
training set and the performance of the model is assessed using the validation
set. More specifically, the validation set is used to estimate the test error
rate. For this, we calculate the mean squared error:</p>
<p><span class="math display">\[
MSE = E(Y_i - \hat{Y_i}) = \frac{1}{n} \sum_{i = 1}^{n}(Y_i - \hat{Y_i})
\]</span></p>
<p>We start by randomly splitting the data set into two parts. Approximately 80% of
the observations are used as training observations, and the other 20% are used
as test observations.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="validation.html#cb2-1" tabindex="-1"></a><span class="co"># Randomly split the data set into a training set (80%) and a test set (20%)</span></span>
<span id="cb2-2"><a href="validation.html#cb2-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-3"><a href="validation.html#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="validation.html#cb2-4" tabindex="-1"></a>trn <span class="ot">&lt;-</span> <span class="fu">sample</span>(n, <span class="fu">round</span>(<span class="fl">0.80</span><span class="sc">*</span>n))</span>
<span id="cb2-5"><a href="validation.html#cb2-5" tabindex="-1"></a>tst <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">:</span>n)[<span class="sc">-</span>trn]</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="validation.html#cb3-1" tabindex="-1"></a><span class="co"># Fit the model to the training set</span></span>
<span id="cb3-2"><a href="validation.html#cb3-2" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb3-3"><a href="validation.html#cb3-3" tabindex="-1"></a>  <span class="at">formula =</span> brain_weight <span class="sc">~</span> head_volume,</span>
<span id="cb3-4"><a href="validation.html#cb3-4" tabindex="-1"></a>  <span class="at">data =</span> brains,</span>
<span id="cb3-5"><a href="validation.html#cb3-5" tabindex="-1"></a>  <span class="at">subset =</span> trn</span>
<span id="cb3-6"><a href="validation.html#cb3-6" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = brain_weight ~ head_volume, data = brains, subset = trn)
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 329.06934   49.82949   6.604 3.99e-10 ***
## head_volume   0.26237    0.01359  19.302  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for gaussian family taken to be 4712.825)
## 
##     Null deviance: 2641859  on 189  degrees of freedom
## Residual deviance:  886011  on 188  degrees of freedom
## AIC: 2150.2
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<p>We calculate the MSE using the test observations as an estimate of the test
error rate.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="validation.html#cb5-1" tabindex="-1"></a><span class="co"># Calculate the mean squared error using the observations from the test set</span></span>
<span id="cb5-2"><a href="validation.html#cb5-2" tabindex="-1"></a>obs_brain_weight <span class="ot">&lt;-</span> brains<span class="sc">$</span>brain_weight</span>
<span id="cb5-3"><a href="validation.html#cb5-3" tabindex="-1"></a>prd_brain_weight <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, brains)</span>
<span id="cb5-4"><a href="validation.html#cb5-4" tabindex="-1"></a>prd_errors <span class="ot">&lt;-</span> (obs_brain_weight <span class="sc">-</span> prd_brain_weight)[tst]</span>
<span id="cb5-5"><a href="validation.html#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="validation.html#cb5-6" tabindex="-1"></a>test_error <span class="ot">&lt;-</span> <span class="fu">mean</span>(prd_errors<span class="sc">**</span><span class="dv">2</span>)</span>
<span id="cb5-7"><a href="validation.html#cb5-7" tabindex="-1"></a>test_error</span></code></pre></div>
<pre><code>## [1] 7378.298</code></pre>
<div id="variability-of-mse" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Variability of MSE<a href="validation.html#variability-of-mse" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Note that the creation of a <strong>training set</strong> and a <strong>test set</strong> is a random
process, and therefore the estimate of the test error is also a random measure.
If we use another split of the data set, we obtain a different estimate of the
test error.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="validation.html#cb7-1" tabindex="-1"></a><span class="co"># Randomly split the data set into a training set (80%) and a test set (20%)</span></span>
<span id="cb7-2"><a href="validation.html#cb7-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb7-3"><a href="validation.html#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="validation.html#cb7-4" tabindex="-1"></a>trn <span class="ot">&lt;-</span> <span class="fu">sample</span>(n, <span class="fu">round</span>(<span class="fl">0.80</span><span class="sc">*</span>n))</span>
<span id="cb7-5"><a href="validation.html#cb7-5" tabindex="-1"></a>tst <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">:</span>n)[<span class="sc">-</span>trn]</span>
<span id="cb7-6"><a href="validation.html#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="validation.html#cb7-7" tabindex="-1"></a><span class="co"># Fit the model to the training set</span></span>
<span id="cb7-8"><a href="validation.html#cb7-8" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb7-9"><a href="validation.html#cb7-9" tabindex="-1"></a>  <span class="at">formula =</span> brain_weight <span class="sc">~</span> head_volume,</span>
<span id="cb7-10"><a href="validation.html#cb7-10" tabindex="-1"></a>  <span class="at">data =</span> brains,</span>
<span id="cb7-11"><a href="validation.html#cb7-11" tabindex="-1"></a>  <span class="at">subset =</span> trn</span>
<span id="cb7-12"><a href="validation.html#cb7-12" tabindex="-1"></a>)</span>
<span id="cb7-13"><a href="validation.html#cb7-13" tabindex="-1"></a></span>
<span id="cb7-14"><a href="validation.html#cb7-14" tabindex="-1"></a><span class="co"># Calculate the mean squared error using the observations from the test set</span></span>
<span id="cb7-15"><a href="validation.html#cb7-15" tabindex="-1"></a>obs_brain_weight <span class="ot">&lt;-</span> brains<span class="sc">$</span>brain_weight</span>
<span id="cb7-16"><a href="validation.html#cb7-16" tabindex="-1"></a>prd_brain_weight <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, brains)</span>
<span id="cb7-17"><a href="validation.html#cb7-17" tabindex="-1"></a>prd_errors <span class="ot">&lt;-</span> (obs_brain_weight <span class="sc">-</span> prd_brain_weight)[tst]</span>
<span id="cb7-18"><a href="validation.html#cb7-18" tabindex="-1"></a></span>
<span id="cb7-19"><a href="validation.html#cb7-19" tabindex="-1"></a>test_error <span class="ot">&lt;-</span> <span class="fu">mean</span>(prd_errors<span class="sc">**</span><span class="dv">2</span>)</span>
<span id="cb7-20"><a href="validation.html#cb7-20" tabindex="-1"></a>test_error</span></code></pre></div>
<pre><code>## [1] 6837.111</code></pre>
<p>To assess the variability of the test error estimates, we repeatedly split the
set of observations into a training set and a test set and compute the MSE.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="validation.html#cb9-1" tabindex="-1"></a><span class="co"># Repeatedly calculate the test error estimate on random splits of the data</span></span>
<span id="cb9-2"><a href="validation.html#cb9-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-3"><a href="validation.html#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="validation.html#cb9-4" tabindex="-1"></a>sim_size <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb9-5"><a href="validation.html#cb9-5" tabindex="-1"></a>test_errors <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">times =</span> sim_size)</span>
<span id="cb9-6"><a href="validation.html#cb9-6" tabindex="-1"></a></span>
<span id="cb9-7"><a href="validation.html#cb9-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>sim_size) {</span>
<span id="cb9-8"><a href="validation.html#cb9-8" tabindex="-1"></a>  </span>
<span id="cb9-9"><a href="validation.html#cb9-9" tabindex="-1"></a>  <span class="co"># Randomly split the data set into a training set (80%) and a test set (20%)</span></span>
<span id="cb9-10"><a href="validation.html#cb9-10" tabindex="-1"></a>  trn <span class="ot">&lt;-</span> <span class="fu">sample</span>(n, <span class="fu">round</span>(<span class="fl">0.80</span><span class="sc">*</span>n))</span>
<span id="cb9-11"><a href="validation.html#cb9-11" tabindex="-1"></a>  tst <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">:</span>n)[<span class="sc">-</span>trn]</span>
<span id="cb9-12"><a href="validation.html#cb9-12" tabindex="-1"></a>  </span>
<span id="cb9-13"><a href="validation.html#cb9-13" tabindex="-1"></a>  <span class="co"># Fit the model to the training set</span></span>
<span id="cb9-14"><a href="validation.html#cb9-14" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb9-15"><a href="validation.html#cb9-15" tabindex="-1"></a>    <span class="at">formula =</span> brain_weight <span class="sc">~</span> head_volume,</span>
<span id="cb9-16"><a href="validation.html#cb9-16" tabindex="-1"></a>    <span class="at">data =</span> brains,</span>
<span id="cb9-17"><a href="validation.html#cb9-17" tabindex="-1"></a>    <span class="at">subset =</span> trn</span>
<span id="cb9-18"><a href="validation.html#cb9-18" tabindex="-1"></a>  )</span>
<span id="cb9-19"><a href="validation.html#cb9-19" tabindex="-1"></a>  </span>
<span id="cb9-20"><a href="validation.html#cb9-20" tabindex="-1"></a>  <span class="co"># Calculate the mean squared error using the observations from the test set</span></span>
<span id="cb9-21"><a href="validation.html#cb9-21" tabindex="-1"></a>  obs_brain_weight <span class="ot">&lt;-</span> brains<span class="sc">$</span>brain_weight</span>
<span id="cb9-22"><a href="validation.html#cb9-22" tabindex="-1"></a>  prd_brain_weight <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, brains)</span>
<span id="cb9-23"><a href="validation.html#cb9-23" tabindex="-1"></a>  prd_errors <span class="ot">&lt;-</span> (obs_brain_weight <span class="sc">-</span> prd_brain_weight)[tst]</span>
<span id="cb9-24"><a href="validation.html#cb9-24" tabindex="-1"></a>  test_errors[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(prd_errors<span class="sc">**</span><span class="dv">2</span>)</span>
<span id="cb9-25"><a href="validation.html#cb9-25" tabindex="-1"></a>  </span>
<span id="cb9-26"><a href="validation.html#cb9-26" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>We see that there is quite some variability in the test error estimates, where
they range from 2176.14 to
8905.89. This is a serious drawback of the validation
set approach, and therefore it is recommended to use other methods to assess
the performance of a model.</p>
</div>
<div id="training-set-size" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Training Set Size<a href="validation.html#training-set-size" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A second drawback is that not all observations are used to fit the model. The
less observations are used to fit a model, the worse the performance of a
model. We illustrate this by, again, repeatedly creating training sets and
fitting the model. But now, we will gradually increase the size of the training
set and investigate how the size of the training set impacts the variability
(uncertainty) of the test error estimates.</p>
<p>Furthermore, the less observations are used to fit the model, the worse the
performance. Therefore, the validation set approach tends to overestimate the
test error if the training set is small.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="validation.html#cb10-1" tabindex="-1"></a><span class="co"># Initialize a seed for reproducibility</span></span>
<span id="cb10-2"><a href="validation.html#cb10-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb10-3"><a href="validation.html#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="validation.html#cb10-4" tabindex="-1"></a><span class="co"># Randomly take 20% of the observations as test observations. These same test </span></span>
<span id="cb10-5"><a href="validation.html#cb10-5" tabindex="-1"></a><span class="co"># observations will be used for every simulation in this code chunk.</span></span>
<span id="cb10-6"><a href="validation.html#cb10-6" tabindex="-1"></a>tst <span class="ot">&lt;-</span> <span class="fu">sample</span>(n, <span class="fu">round</span>(<span class="fl">0.20</span><span class="sc">*</span>n))</span>
<span id="cb10-7"><a href="validation.html#cb10-7" tabindex="-1"></a>tst_observations <span class="ot">&lt;-</span> brains[tst, ]</span>
<span id="cb10-8"><a href="validation.html#cb10-8" tabindex="-1"></a>trn_observations <span class="ot">&lt;-</span> brains[<span class="sc">-</span>tst, ]</span>
<span id="cb10-9"><a href="validation.html#cb10-9" tabindex="-1"></a></span>
<span id="cb10-10"><a href="validation.html#cb10-10" tabindex="-1"></a>trn_sizes <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.1</span>, <span class="at">to =</span> <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb10-11"><a href="validation.html#cb10-11" tabindex="-1"></a>sim_size <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb10-12"><a href="validation.html#cb10-12" tabindex="-1"></a></span>
<span id="cb10-13"><a href="validation.html#cb10-13" tabindex="-1"></a><span class="cf">for</span> (trn_size <span class="cf">in</span> trn_sizes) {</span>
<span id="cb10-14"><a href="validation.html#cb10-14" tabindex="-1"></a>  </span>
<span id="cb10-15"><a href="validation.html#cb10-15" tabindex="-1"></a>  test_errors <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">times =</span> sim_size)</span>
<span id="cb10-16"><a href="validation.html#cb10-16" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>sim_size) {</span>
<span id="cb10-17"><a href="validation.html#cb10-17" tabindex="-1"></a>    </span>
<span id="cb10-18"><a href="validation.html#cb10-18" tabindex="-1"></a>    <span class="co"># Randomly select observations as training observations</span></span>
<span id="cb10-19"><a href="validation.html#cb10-19" tabindex="-1"></a>    trn <span class="ot">&lt;-</span> <span class="fu">sample</span>(</span>
<span id="cb10-20"><a href="validation.html#cb10-20" tabindex="-1"></a>      <span class="fu">nrow</span>(trn_observations),</span>
<span id="cb10-21"><a href="validation.html#cb10-21" tabindex="-1"></a>      <span class="fu">round</span>(trn_size<span class="sc">*</span><span class="fu">nrow</span>(trn_observations))</span>
<span id="cb10-22"><a href="validation.html#cb10-22" tabindex="-1"></a>    )</span>
<span id="cb10-23"><a href="validation.html#cb10-23" tabindex="-1"></a>    </span>
<span id="cb10-24"><a href="validation.html#cb10-24" tabindex="-1"></a>    <span class="co"># Fit the model to the training set</span></span>
<span id="cb10-25"><a href="validation.html#cb10-25" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb10-26"><a href="validation.html#cb10-26" tabindex="-1"></a>      <span class="at">formula =</span> brain_weight <span class="sc">~</span> head_volume,</span>
<span id="cb10-27"><a href="validation.html#cb10-27" tabindex="-1"></a>      <span class="at">data =</span> trn_observations,</span>
<span id="cb10-28"><a href="validation.html#cb10-28" tabindex="-1"></a>      <span class="at">subset =</span> trn</span>
<span id="cb10-29"><a href="validation.html#cb10-29" tabindex="-1"></a>    )</span>
<span id="cb10-30"><a href="validation.html#cb10-30" tabindex="-1"></a>    </span>
<span id="cb10-31"><a href="validation.html#cb10-31" tabindex="-1"></a>    <span class="co"># Calculate the mean squared error using the observations from the test set</span></span>
<span id="cb10-32"><a href="validation.html#cb10-32" tabindex="-1"></a>    obs_brain_weight <span class="ot">&lt;-</span> tst_observations<span class="sc">$</span>brain_weight</span>
<span id="cb10-33"><a href="validation.html#cb10-33" tabindex="-1"></a>    prd_brain_weight <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, tst_observations)</span>
<span id="cb10-34"><a href="validation.html#cb10-34" tabindex="-1"></a>    prd_errors <span class="ot">&lt;-</span> (obs_brain_weight <span class="sc">-</span> prd_brain_weight)</span>
<span id="cb10-35"><a href="validation.html#cb10-35" tabindex="-1"></a>    test_errors[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(prd_errors<span class="sc">**</span><span class="dv">2</span>)</span>
<span id="cb10-36"><a href="validation.html#cb10-36" tabindex="-1"></a>    </span>
<span id="cb10-37"><a href="validation.html#cb10-37" tabindex="-1"></a>  }</span>
<span id="cb10-38"><a href="validation.html#cb10-38" tabindex="-1"></a>  </span>
<span id="cb10-39"><a href="validation.html#cb10-39" tabindex="-1"></a>  mean_test_error <span class="ot">&lt;-</span> <span class="fu">mean</span>(test_errors)</span>
<span id="cb10-40"><a href="validation.html#cb10-40" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Mean test error : &quot;</span>, <span class="fu">round</span>(mean_test_error, <span class="dv">2</span>)))</span>
<span id="cb10-41"><a href="validation.html#cb10-41" tabindex="-1"></a>  test_error_range <span class="ot">&lt;-</span> <span class="fu">max</span>(test_errors) <span class="sc">-</span> <span class="fu">min</span>(test_errors)</span>
<span id="cb10-42"><a href="validation.html#cb10-42" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Range : &quot;</span>, <span class="fu">round</span>(test_error_range, <span class="dv">2</span>)))</span>
<span id="cb10-43"><a href="validation.html#cb10-43" tabindex="-1"></a>  <span class="fu">hist</span>(</span>
<span id="cb10-44"><a href="validation.html#cb10-44" tabindex="-1"></a>    test_errors,</span>
<span id="cb10-45"><a href="validation.html#cb10-45" tabindex="-1"></a>    <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;Distribution of Test Error Estimates (&quot;</span>, trn_size, <span class="st">&quot;)&quot;</span>),</span>
<span id="cb10-46"><a href="validation.html#cb10-46" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Test error estimate&quot;</span>,</span>
<span id="cb10-47"><a href="validation.html#cb10-47" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Count&quot;</span></span>
<span id="cb10-48"><a href="validation.html#cb10-48" tabindex="-1"></a>  )</span>
<span id="cb10-49"><a href="validation.html#cb10-49" tabindex="-1"></a>  </span>
<span id="cb10-50"><a href="validation.html#cb10-50" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Mean test error : 6101.64&quot;
## [1] &quot;Range : 10166.31&quot;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre><code>## [1] &quot;Mean test error : 5693.02&quot;
## [1] &quot;Range : 5161.19&quot;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<pre><code>## [1] &quot;Mean test error : 5595.77&quot;
## [1] &quot;Range : 2912.03&quot;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-10-3.png" width="672" /></p>
<pre><code>## [1] &quot;Mean test error : 5532.75&quot;
## [1] &quot;Range : 2952.36&quot;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-10-4.png" width="672" /></p>
<pre><code>## [1] &quot;Mean test error : 5490.38&quot;
## [1] &quot;Range : 2104.9&quot;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-10-5.png" width="672" /></p>
<pre><code>## [1] &quot;Mean test error : 5460.82&quot;
## [1] &quot;Range : 1806.83&quot;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-10-6.png" width="672" /></p>
<pre><code>## [1] &quot;Mean test error : 5441.94&quot;
## [1] &quot;Range : 1757.41&quot;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-10-7.png" width="672" /></p>
<pre><code>## [1] &quot;Mean test error : 5429.91&quot;
## [1] &quot;Range : 957.38&quot;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-10-8.png" width="672" /></p>
<pre><code>## [1] &quot;Mean test error : 5420.85&quot;
## [1] &quot;Range : 690.75&quot;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-10-9.png" width="672" /></p>
</div>
</div>
<div id="leave-one-out-cross-validation" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Leave-One-Out Cross-Validation<a href="validation.html#leave-one-out-cross-validation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Leave-on-out cross-validation (LOOCV) also splits the complete data set into a
training set and a test set. The test set, however, comprises a single
observation. Furthermore, each observation is used once as a test observation.
This approach yields <span class="math inline">\(n\)</span> squared errors. Averaging these <span class="math inline">\(n\)</span> squared errors
then gives us the LOOCV estimate of the test error.</p>
<p><span class="math display">\[
CV_{(n)} = \frac{1}{n} \sum_{i = 1}^{n} MSE_i
\]</span></p>
<p>First, we manually calculate the LOOCV estimate of the test error.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="validation.html#cb20-1" tabindex="-1"></a><span class="co"># Initialize a vector to hold the errors for each observation, that is each time </span></span>
<span id="cb20-2"><a href="validation.html#cb20-2" tabindex="-1"></a><span class="co"># is used as a test observation</span></span>
<span id="cb20-3"><a href="validation.html#cb20-3" tabindex="-1"></a>prd_errors <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">times =</span> n)</span>
<span id="cb20-4"><a href="validation.html#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="validation.html#cb20-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb20-6"><a href="validation.html#cb20-6" tabindex="-1"></a>  </span>
<span id="cb20-7"><a href="validation.html#cb20-7" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> brain_weight <span class="sc">~</span> head_volume, <span class="at">data =</span> brains[<span class="sc">-</span>i, ])</span>
<span id="cb20-8"><a href="validation.html#cb20-8" tabindex="-1"></a>  prd_brain_weight <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, brains[i, ])</span>
<span id="cb20-9"><a href="validation.html#cb20-9" tabindex="-1"></a>  obs_brain_weight <span class="ot">&lt;-</span> brains[[i, <span class="st">&quot;brain_weight&quot;</span>]]</span>
<span id="cb20-10"><a href="validation.html#cb20-10" tabindex="-1"></a>  prd_errors[i] <span class="ot">&lt;-</span> (obs_brain_weight <span class="sc">-</span> prd_brain_weight)</span>
<span id="cb20-11"><a href="validation.html#cb20-11" tabindex="-1"></a>  </span>
<span id="cb20-12"><a href="validation.html#cb20-12" tabindex="-1"></a>}</span>
<span id="cb20-13"><a href="validation.html#cb20-13" tabindex="-1"></a></span>
<span id="cb20-14"><a href="validation.html#cb20-14" tabindex="-1"></a>loocv_estimate <span class="ot">&lt;-</span> <span class="fu">mean</span>(loocv_errors<span class="sc">**</span><span class="dv">2</span>)</span>
<span id="cb20-15"><a href="validation.html#cb20-15" tabindex="-1"></a>loocv_estimate</span></code></pre></div>
<pre><code>## [1] 5293.103</code></pre>
<p>We obtain an estimate of 5293.1 for the test error. We
can also just use the <code>boot</code> library to calculate the test error.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="validation.html#cb22-1" tabindex="-1"></a><span class="co"># Fit a model to the complete data set</span></span>
<span id="cb22-2"><a href="validation.html#cb22-2" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb22-3"><a href="validation.html#cb22-3" tabindex="-1"></a>  <span class="at">formula =</span> brain_weight <span class="sc">~</span> head_volume,</span>
<span id="cb22-4"><a href="validation.html#cb22-4" tabindex="-1"></a>  <span class="at">data =</span> brains</span>
<span id="cb22-5"><a href="validation.html#cb22-5" tabindex="-1"></a>)</span>
<span id="cb22-6"><a href="validation.html#cb22-6" tabindex="-1"></a></span>
<span id="cb22-7"><a href="validation.html#cb22-7" tabindex="-1"></a><span class="co"># Calculate the LOOCV test error estimate using the boot library</span></span>
<span id="cb22-8"><a href="validation.html#cb22-8" tabindex="-1"></a>loocv_error <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(brains, fit_loo)<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb22-9"><a href="validation.html#cb22-9" tabindex="-1"></a>loocv_error</span></code></pre></div>
<pre><code>## [1] 5293.103</code></pre>
<div id="variability-of-mse-1" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Variability of MSE<a href="validation.html#variability-of-mse-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>THERE IS NO LONGER ANY VARIABILITY IN THE LOOCV ESTIMATES</p>
<p>IT WILL ALWAYS BE THE SAME (THERE IS NO RANDOMNESS)</p>
</div>
<div id="training-set-size-1" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Training Set Size<a href="validation.html#training-set-size-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>THE TRAINING SET IS LARGER AS COMPARED TO THE VALIDATION SET APPROACH</p>
<p>THE TEST ERROR WILL NOT BE AS OVERESTIMATED AS COMPARED TO THE VALIDATION SET APPROACH</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="logistic-models-and-deviance.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/03-validation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
