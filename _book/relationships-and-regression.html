<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Relationships and Regression | Stats For You</title>
  <meta name="description" content="<p>This book provides an introduction to various topics in statistics and
probability.</p>" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Relationships and Regression | Stats For You" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This book provides an introduction to various topics in statistics and
probability.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Relationships and Regression | Stats For You" />
  
  <meta name="twitter:description" content="<p>This book provides an introduction to various topics in statistics and
probability.</p>" />
  

<meta name="author" content="Frederick De Baene" />


<meta name="date" content="2025-12-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="missingness.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Stats For You</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a></li>
<li class="chapter" data-level="2" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html"><i class="fa fa-check"></i><b>2</b> Logistic Models and Deviance</a>
<ul>
<li class="chapter" data-level="2.1" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#models"><i class="fa fa-check"></i><b>2.1</b> Models</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#proposed-model"><i class="fa fa-check"></i><b>2.1.1</b> Proposed Model</a></li>
<li class="chapter" data-level="2.1.2" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#null-model"><i class="fa fa-check"></i><b>2.1.2</b> Null Model</a></li>
<li class="chapter" data-level="2.1.3" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#saturated-model"><i class="fa fa-check"></i><b>2.1.3</b> Saturated Model</a></li>
<li class="chapter" data-level="2.1.4" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#models-and-deviance"><i class="fa fa-check"></i><b>2.1.4</b> Models and Deviance</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#likelihood-and-log-likelihood"><i class="fa fa-check"></i><b>2.2</b> Likelihood and Log-Likelihood</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#proposed-model-1"><i class="fa fa-check"></i><b>2.2.1</b> Proposed Model</a></li>
<li class="chapter" data-level="2.2.2" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#null-model-1"><i class="fa fa-check"></i><b>2.2.2</b> Null Model</a></li>
<li class="chapter" data-level="2.2.3" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#saturated-model-1"><i class="fa fa-check"></i><b>2.2.3</b> Saturated Model</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="logistic-models-and-deviance.html"><a href="logistic-models-and-deviance.html#deviance"><i class="fa fa-check"></i><b>2.3</b> Deviance</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>3</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="logistic-regression.html"><a href="logistic-regression.html#ordinary-logistic-regression"><i class="fa fa-check"></i><b>3.1</b> Ordinary Logistic Regression</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="logistic-regression.html"><a href="logistic-regression.html#context"><i class="fa fa-check"></i><b>3.1.1</b> Context</a></li>
<li class="chapter" data-level="3.1.2" data-path="logistic-regression.html"><a href="logistic-regression.html#model-fitting"><i class="fa fa-check"></i><b>3.1.2</b> Model Fitting</a></li>
<li class="chapter" data-level="3.1.3" data-path="logistic-regression.html"><a href="logistic-regression.html#interpretation"><i class="fa fa-check"></i><b>3.1.3</b> Interpretation</a></li>
<li class="chapter" data-level="3.1.4" data-path="logistic-regression.html"><a href="logistic-regression.html#maximum-likelihood-estimation"><i class="fa fa-check"></i><b>3.1.4</b> Maximum Likelihood Estimation</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="logistic-regression.html"><a href="logistic-regression.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>3.2</b> Conditional Logistic Regression</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="logistic-regression.html"><a href="logistic-regression.html#definition"><i class="fa fa-check"></i><b>3.2.1</b> Definition</a></li>
<li class="chapter" data-level="3.2.2" data-path="logistic-regression.html"><a href="logistic-regression.html#probability"><i class="fa fa-check"></i><b>3.2.2</b> Probability</a></li>
<li class="chapter" data-level="3.2.3" data-path="logistic-regression.html"><a href="logistic-regression.html#conditional-probability"><i class="fa fa-check"></i><b>3.2.3</b> Conditional Probability</a></li>
<li class="chapter" data-level="3.2.4" data-path="logistic-regression.html"><a href="logistic-regression.html#probability-1"><i class="fa fa-check"></i><b>3.2.4</b> Probability</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="missingness.html"><a href="missingness.html"><i class="fa fa-check"></i><b>4</b> Missingness</a>
<ul>
<li class="chapter" data-level="4.1" data-path="missingness.html"><a href="missingness.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="missingness.html"><a href="missingness.html#missingess-patterns"><i class="fa fa-check"></i><b>4.2</b> Missingess Patterns</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="missingness.html"><a href="missingness.html#simulation-setup"><i class="fa fa-check"></i><b>4.2.1</b> Simulation Setup</a></li>
<li class="chapter" data-level="4.2.2" data-path="missingness.html"><a href="missingness.html#missingness-completely-at-random"><i class="fa fa-check"></i><b>4.2.2</b> Missingness Completely at Random</a></li>
<li class="chapter" data-level="4.2.3" data-path="missingness.html"><a href="missingness.html#missingness-at-random"><i class="fa fa-check"></i><b>4.2.3</b> Missingness at Random</a></li>
<li class="chapter" data-level="4.2.4" data-path="missingness.html"><a href="missingness.html#missingness-not-at-random"><i class="fa fa-check"></i><b>4.2.4</b> Missingness Not at Random</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="relationships-and-regression.html"><a href="relationships-and-regression.html"><i class="fa fa-check"></i><b>5</b> Relationships and Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="relationships-and-regression.html"><a href="relationships-and-regression.html#relationships"><i class="fa fa-check"></i><b>5.1</b> Relationships</a></li>
<li class="chapter" data-level="5.2" data-path="relationships-and-regression.html"><a href="relationships-and-regression.html#pearson-correlation-coefficient"><i class="fa fa-check"></i><b>5.2</b> Pearson Correlation Coefficient</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="relationships-and-regression.html"><a href="relationships-and-regression.html#calculating-coefficient"><i class="fa fa-check"></i><b>5.2.1</b> Calculating Coefficient</a></li>
<li class="chapter" data-level="5.2.2" data-path="relationships-and-regression.html"><a href="relationships-and-regression.html#hypothesis-testing"><i class="fa fa-check"></i><b>5.2.2</b> Hypothesis Testing</a></li>
<li class="chapter" data-level="5.2.3" data-path="relationships-and-regression.html"><a href="relationships-and-regression.html#no-relationship"><i class="fa fa-check"></i><b>5.2.3</b> No Relationship</a></li>
<li class="chapter" data-level="5.2.4" data-path="relationships-and-regression.html"><a href="relationships-and-regression.html#orange-dataset"><i class="fa fa-check"></i><b>5.2.4</b> Orange Dataset</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="relationships-and-regression.html"><a href="relationships-and-regression.html#spearman-rank-correlation"><i class="fa fa-check"></i><b>5.3</b> Spearman Rank Correlation</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stats For You</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="relationships-and-regression" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Relationships and Regression<a href="relationships-and-regression.html#relationships-and-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="relationships" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Relationships<a href="relationships-and-regression.html#relationships" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Two random variables are related if changes in one variable are consistently
associated with changes in another variable. Or, in other words, when the two
random variables tend to change together. We say that the two variables have a
relationship (or relation).</p>
<p>When describing relationships between variables, we must take into account (1)
the pattern, (2) the direction, and (3) the strength of the relationship. The
pattern of the relationship focuses on the shape of the regression curve of the
relationship. This can be linear, quadratic, exponential, etc. The relationship
can be positive or negative (direction). And the relationship can be strong or
weak. We will come back on the topic of strength of a relationship when
discussing the Pearson correlation coefficient.</p>
<p>As an example, let us have a look at the <strong>Orange</strong> dataset. This dataset
contains 35 observations on two random variables: age in days and circumference
in millimeters. In the following figure, we see that an increase in age tends to
be associated with an increase in circumference. Or, in other words, relatively
low values for age tend to occur with relatively low values for circumference,
and relatively high values for age tend to occur with relatively high values for
circumference. This indicates a positive relationship. When drawing a smoother
through the data, it seems the relationship can be described with an
approximately straight line, making it a linear relationship.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="relationships-and-regression.html#cb1-1" tabindex="-1"></a><span class="fu">ggplot</span>(Orange, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> circumference)) <span class="sc">+</span></span>
<span id="cb1-2"><a href="relationships-and-regression.html#cb1-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1-3"><a href="relationships-and-regression.html#cb1-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;y ~ x&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb1-4"><a href="relationships-and-regression.html#cb1-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Age (days)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Circumference (mm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1-5"><a href="relationships-and-regression.html#cb1-5" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>In the following sections, we will focus on statistical measures that can be
used to describe linear relationships.</p>
</div>
<div id="pearson-correlation-coefficient" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Pearson Correlation Coefficient<a href="relationships-and-regression.html#pearson-correlation-coefficient" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Pearson correlation coefficient is a statistical measure that quantifies the
direction and strength of a linear relationship between two variables. The sign
of the Pearson correlation coefficient indicates the direction and the absolute
value, ranging from <span class="math inline">\(0\)</span> to <span class="math inline">\(1\)</span>, indicates the strength of the relationship.</p>
<div id="calculating-coefficient" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Calculating Coefficient<a href="relationships-and-regression.html#calculating-coefficient" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Pearson correlation coefficient is calculated as follows:</p>
<p><span class="math display">\[
\rho = \frac{Cov(X, Y)}{\sigma_{X} \sigma_{Y}} = \frac{\sigma_{XY}}{\sigma_{X} \sigma_{Y}}
\]</span></p>
<p>Note that <span class="math inline">\(\rho\)</span> denotes the population Pearson correlation coefficient, while
<span class="math inline">\(r\)</span> denotes the sample correlation coefficient. The latter is calculated as
follows:</p>
<p><span class="math display">\[
r = \frac{s_{XY}}{s_{X} s_{Y}}
\]</span></p>
<p>Dividing the covariance between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> by the product of the standard
deviations of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> ensures that the correlation coefficient is not
dependent on the scale of the variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> and that <span class="math inline">\(\rho \in [-1,
+1]\)</span>. If <span class="math inline">\(\rho = +1\)</span>, then all of the data falls on a single straight line with
a positive slope. Some examples:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="relationships-and-regression.html#cb2-1" tabindex="-1"></a><span class="co"># Create a sample dataset</span></span>
<span id="cb2-2"><a href="relationships-and-regression.html#cb2-2" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">X =</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">min =</span> <span class="dv">10</span>, <span class="at">max =</span> <span class="dv">80</span>))</span>
<span id="cb2-3"><a href="relationships-and-regression.html#cb2-3" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">add_column</span>(dat, <span class="at">Y1 =</span> <span class="fl">0.30</span><span class="sc">*</span>dat<span class="sc">$</span>X)</span>
<span id="cb2-4"><a href="relationships-and-regression.html#cb2-4" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">add_column</span>(dat, <span class="at">Y2 =</span> <span class="fl">3.00</span><span class="sc">*</span>dat<span class="sc">$</span>X)</span>
<span id="cb2-5"><a href="relationships-and-regression.html#cb2-5" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">add_column</span>(dat, <span class="at">Y3 =</span> <span class="fl">30.0</span><span class="sc">*</span>dat<span class="sc">$</span>X)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="relationships-and-regression.html#cb3-1" tabindex="-1"></a><span class="co"># Visualize the relationships</span></span>
<span id="cb3-2"><a href="relationships-and-regression.html#cb3-2" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> X)) <span class="sc">+</span></span>
<span id="cb3-3"><a href="relationships-and-regression.html#cb3-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y1), <span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-4"><a href="relationships-and-regression.html#cb3-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="fu">aes</span>(<span class="at">y =</span> Y1), <span class="at">formula =</span> <span class="st">&quot;y ~ x&quot;</span>, <span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>, <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb3-5"><a href="relationships-and-regression.html#cb3-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y2), <span class="at">color =</span> <span class="st">&quot;darkgreen&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-6"><a href="relationships-and-regression.html#cb3-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="fu">aes</span>(<span class="at">y =</span> Y2), <span class="at">formula =</span> <span class="st">&quot;y ~ x&quot;</span>, <span class="at">color =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb3-7"><a href="relationships-and-regression.html#cb3-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y3), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-8"><a href="relationships-and-regression.html#cb3-8" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="fu">aes</span>(<span class="at">y =</span> Y3), <span class="at">formula =</span> <span class="st">&quot;y ~ x&quot;</span>, <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb3-9"><a href="relationships-and-regression.html#cb3-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;X&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Y&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-10"><a href="relationships-and-regression.html#cb3-10" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Note that these examples illustrate a functional relationship. The relationship
between <span class="math inline">\(X\)</span> and each of the <span class="math inline">\(Y\)</span> variables (<span class="math inline">\(Y1\)</span>, <span class="math inline">\(Y2\)</span>, <span class="math inline">\(Y3\)</span>) can be described
by an equation and all the observations fall on the line of the relationship. If
we compute the Pearson correlation coefficients for each of these three pairs
of variables, we see that it is each time equal to <span class="math inline">\(r = +1\)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="relationships-and-regression.html#cb4-1" tabindex="-1"></a><span class="fu">cor</span>(<span class="at">x =</span> dat<span class="sc">$</span>X, <span class="at">y =</span> dat<span class="sc">$</span>Y1, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="relationships-and-regression.html#cb6-1" tabindex="-1"></a><span class="fu">cor</span>(<span class="at">x =</span> dat<span class="sc">$</span>X, <span class="at">y =</span> dat<span class="sc">$</span>Y2, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="relationships-and-regression.html#cb8-1" tabindex="-1"></a><span class="fu">cor</span>(<span class="at">x =</span> dat<span class="sc">$</span>X, <span class="at">y =</span> dat<span class="sc">$</span>Y3, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>If we now use a negative slope, we will see that the Pearson correlation
coefficient for each of these functional relationships equals <span class="math inline">\(r = -1\)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="relationships-and-regression.html#cb10-1" tabindex="-1"></a><span class="co"># Create a sample dataset</span></span>
<span id="cb10-2"><a href="relationships-and-regression.html#cb10-2" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">X =</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">min =</span> <span class="dv">10</span>, <span class="at">max =</span> <span class="dv">80</span>))</span>
<span id="cb10-3"><a href="relationships-and-regression.html#cb10-3" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">add_column</span>(dat, <span class="at">Y1 =</span> <span class="sc">-</span><span class="fl">0.30</span><span class="sc">*</span>dat<span class="sc">$</span>X)</span>
<span id="cb10-4"><a href="relationships-and-regression.html#cb10-4" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">add_column</span>(dat, <span class="at">Y2 =</span> <span class="sc">-</span><span class="fl">3.00</span><span class="sc">*</span>dat<span class="sc">$</span>X)</span>
<span id="cb10-5"><a href="relationships-and-regression.html#cb10-5" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">add_column</span>(dat, <span class="at">Y3 =</span> <span class="sc">-</span><span class="fl">30.0</span><span class="sc">*</span>dat<span class="sc">$</span>X)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="relationships-and-regression.html#cb11-1" tabindex="-1"></a><span class="co"># Visualize the relationships</span></span>
<span id="cb11-2"><a href="relationships-and-regression.html#cb11-2" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> X)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="relationships-and-regression.html#cb11-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y1), <span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-4"><a href="relationships-and-regression.html#cb11-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="fu">aes</span>(<span class="at">y =</span> Y1), <span class="at">formula =</span> <span class="st">&quot;y ~ x&quot;</span>, <span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>, <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb11-5"><a href="relationships-and-regression.html#cb11-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y2), <span class="at">color =</span> <span class="st">&quot;darkgreen&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-6"><a href="relationships-and-regression.html#cb11-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="fu">aes</span>(<span class="at">y =</span> Y2), <span class="at">formula =</span> <span class="st">&quot;y ~ x&quot;</span>, <span class="at">color =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb11-7"><a href="relationships-and-regression.html#cb11-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y3), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-8"><a href="relationships-and-regression.html#cb11-8" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="fu">aes</span>(<span class="at">y =</span> Y3), <span class="at">formula =</span> <span class="st">&quot;y ~ x&quot;</span>, <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb11-9"><a href="relationships-and-regression.html#cb11-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;X&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Y&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-10"><a href="relationships-and-regression.html#cb11-10" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="relationships-and-regression.html#cb12-1" tabindex="-1"></a><span class="fu">cor</span>(<span class="at">x =</span> dat<span class="sc">$</span>X, <span class="at">y =</span> dat<span class="sc">$</span>Y1, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## [1] -1</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="relationships-and-regression.html#cb14-1" tabindex="-1"></a><span class="fu">cor</span>(<span class="at">x =</span> dat<span class="sc">$</span>X, <span class="at">y =</span> dat<span class="sc">$</span>Y2, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## [1] -1</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="relationships-and-regression.html#cb16-1" tabindex="-1"></a><span class="fu">cor</span>(<span class="at">x =</span> dat<span class="sc">$</span>X, <span class="at">y =</span> dat<span class="sc">$</span>Y3, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## [1] -1</code></pre>
<p>We see that the absolute value of the Pearson correlation coefficient equals <span class="math inline">\(1\)</span>
for the six examples. This indicates that these are very strong linear
relationships. But what does it mean for a relationship between two variables to
be strong?</p>
<p>The strength of a relationship between two variables is an indication of how
much information a given value for one variables gives us about the value of the
other variable. If we see that for a given value of <span class="math inline">\(X\)</span> the range of values for
<span class="math inline">\(Y\)</span> is relatively large, and this for every value of <span class="math inline">\(X\)</span>, then we cannot say
that <span class="math inline">\(X\)</span> carries much information about <span class="math inline">\(Y\)</span>. If, however, the range of values
for <span class="math inline">\(Y\)</span> is relatively small for every value of <span class="math inline">\(X\)</span>, then we can state that <span class="math inline">\(X\)</span>
carries a lot of information about the value of <span class="math inline">\(Y\)</span> and the relationship is
quite strong.</p>
<p>We will showcase with a few examples.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="relationships-and-regression.html#cb18-1" tabindex="-1"></a><span class="co"># Create a sample dataset</span></span>
<span id="cb18-2"><a href="relationships-and-regression.html#cb18-2" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">X =</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="at">min =</span> <span class="dv">20</span>, <span class="at">max =</span> <span class="dv">40</span>))</span>
<span id="cb18-3"><a href="relationships-and-regression.html#cb18-3" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">add_column</span>(dat, <span class="at">Y1 =</span> <span class="sc">-</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">5</span><span class="sc">*</span>dat<span class="sc">$</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">1</span>))</span>
<span id="cb18-4"><a href="relationships-and-regression.html#cb18-4" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">add_column</span>(dat, <span class="at">Y2 =</span> <span class="sc">-</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">5</span><span class="sc">*</span>dat<span class="sc">$</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">10</span>))</span>
<span id="cb18-5"><a href="relationships-and-regression.html#cb18-5" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">add_column</span>(dat, <span class="at">Y3 =</span> <span class="sc">-</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">5</span><span class="sc">*</span>dat<span class="sc">$</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">25</span>))</span></code></pre></div>
<p>For the following three positive linear relationships, we see that the amount of
scatter around the regression line is different for the three examples. The
amount of scatter around the regression line is an indication of how much
information the variable <span class="math inline">\(X\)</span> carries about the variable <span class="math inline">\(Y\)</span>.</p>
<p>If we look at any given value for <span class="math inline">\(X\)</span>, we see that the range of observed values
for <span class="math inline">\(Y1\)</span> is relatively small. For <span class="math inline">\(Y2\)</span>, the range of observed <span class="math inline">\(Y2\)</span> values is
larger. And for <span class="math inline">\(Y3\)</span>, the range of observed <span class="math inline">\(Y3\)</span> values is relatively large.
Therefore, we can state that the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y1\)</span> is strong,
between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y2\)</span> is moderate, and between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y3\)</span> is weak.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="relationships-and-regression.html#cb19-1" tabindex="-1"></a><span class="co"># Visualize the relationships</span></span>
<span id="cb19-2"><a href="relationships-and-regression.html#cb19-2" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> X)) <span class="sc">+</span></span>
<span id="cb19-3"><a href="relationships-and-regression.html#cb19-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y1), <span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="relationships-and-regression.html#cb19-4" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">slope =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-5"><a href="relationships-and-regression.html#cb19-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;X&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Y1&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-6"><a href="relationships-and-regression.html#cb19-6" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">250</span>)) <span class="sc">+</span></span>
<span id="cb19-7"><a href="relationships-and-regression.html#cb19-7" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="relationships-and-regression.html#cb20-1" tabindex="-1"></a><span class="co"># Visualize the relationships</span></span>
<span id="cb20-2"><a href="relationships-and-regression.html#cb20-2" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> X)) <span class="sc">+</span></span>
<span id="cb20-3"><a href="relationships-and-regression.html#cb20-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y2), <span class="at">color =</span> <span class="st">&quot;darkgreen&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-4"><a href="relationships-and-regression.html#cb20-4" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">slope =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;darkgreen&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="relationships-and-regression.html#cb20-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;X&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Y2&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-6"><a href="relationships-and-regression.html#cb20-6" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">250</span>)) <span class="sc">+</span></span>
<span id="cb20-7"><a href="relationships-and-regression.html#cb20-7" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="relationships-and-regression.html#cb21-1" tabindex="-1"></a><span class="co"># Visualize the relationships</span></span>
<span id="cb21-2"><a href="relationships-and-regression.html#cb21-2" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> X)) <span class="sc">+</span></span>
<span id="cb21-3"><a href="relationships-and-regression.html#cb21-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y3), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb21-4"><a href="relationships-and-regression.html#cb21-4" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">slope =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb21-5"><a href="relationships-and-regression.html#cb21-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;X&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Y3&quot;</span>) <span class="sc">+</span></span>
<span id="cb21-6"><a href="relationships-and-regression.html#cb21-6" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">250</span>)) <span class="sc">+</span></span>
<span id="cb21-7"><a href="relationships-and-regression.html#cb21-7" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>The absolute values of the Pearson correlation coefficient are indicative of
the strength of the linear relationship. Therefore, we expect the largest
Pearson correlation coefficient for <span class="math inline">\(X\)</span> and <span class="math inline">\(Y1\)</span>, a smaller one for <span class="math inline">\(X\)</span> and
<span class="math inline">\(Y2\)</span>, and the smallest one for <span class="math inline">\(X\)</span> and <span class="math inline">\(Y3\)</span>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="relationships-and-regression.html#cb22-1" tabindex="-1"></a><span class="fu">cor</span>(<span class="at">x =</span> dat<span class="sc">$</span>X, <span class="at">y =</span> dat<span class="sc">$</span>Y1, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 0.9993038</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="relationships-and-regression.html#cb24-1" tabindex="-1"></a><span class="fu">cor</span>(<span class="at">x =</span> dat<span class="sc">$</span>X, <span class="at">y =</span> dat<span class="sc">$</span>Y2, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 0.9429303</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="relationships-and-regression.html#cb26-1" tabindex="-1"></a><span class="fu">cor</span>(<span class="at">x =</span> dat<span class="sc">$</span>X, <span class="at">y =</span> dat<span class="sc">$</span>Y3, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 0.703926</code></pre>
</div>
<div id="hypothesis-testing" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Hypothesis Testing<a href="relationships-and-regression.html#hypothesis-testing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All of the above examples on the Pearson correlation coefficient made use of
samples of data to calculate the correlation. When analyzing data, we must be
be aware that often we are analyzing a sample of data which is drawn from a
larger population. For this population, there is a true Pearson correlation
coefficient <span class="math inline">\(\rho\)</span>, which is an unknown constant. To estimate <span class="math inline">\(\rho\)</span>, we draw
a random sample from the population and use an estimator to produce an estimate
<span class="math inline">\(\hat{\rho}\)</span>. We have already seen the estimator in this chapter. It is:</p>
<p><span class="math display">\[
r = \frac{s_{XY}}{s_{X} s_{Y}}
\]</span></p>
<p>We must remember that the Pearson correlation coefficient <span class="math inline">\(r\)</span> is an estimator
for the true Pearson correlation coefficient <span class="math inline">\(\rho\)</span> in the population. The
latter is an unknown constant. We want to estimate this unknown constant and
therefore we sample data from the population and analyze this data to produce an
estimate of the true value of <span class="math inline">\(\rho\)</span>.</p>
<p>Using this, we can perform a <span class="math inline">\(t\)</span>-test to test for the existence of a linear
relationship between two variables. The null hypothesis states that the
population correlation coefficient <span class="math inline">\(\rho = 0\)</span> and that there is no linear
relationship:</p>
<p><span class="math display">\[
H_0 : \rho = 0
\]</span></p>
<p>The alternative hypothesis states:</p>
<p><span class="math display">\[
H_a : \rho \neq 0
\]</span></p>
<p>The test statistic <span class="math inline">\(T\)</span> for this test is:</p>
<p><span class="math display">\[
T = \frac{r \cdot \sqrt{n - 2}}{\sqrt{1 - R^2}}
\]</span></p>
<p>The test statistic <span class="math inline">\(T\)</span> follows a <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(n - 2\)</span> degrees of
freedom.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="relationships-and-regression.html#cb28-1" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="at">x =</span> dat<span class="sc">$</span>X, <span class="at">y =</span> dat<span class="sc">$</span>Y1, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  dat$X and dat$Y1
## t = 265.15, df = 98, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.9989636 0.9995323
## sample estimates:
##       cor 
## 0.9993038</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="relationships-and-regression.html#cb30-1" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="at">x =</span> dat<span class="sc">$</span>X, <span class="at">y =</span> dat<span class="sc">$</span>Y2, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  dat$X and dat$Y2
## t = 28.032, df = 98, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.9162004 0.9613063
## sample estimates:
##       cor 
## 0.9429303</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="relationships-and-regression.html#cb32-1" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="at">x =</span> dat<span class="sc">$</span>X, <span class="at">y =</span> dat<span class="sc">$</span>Y3, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  dat$X and dat$Y3
## t = 9.811, df = 98, p-value = 3.112e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.5889364 0.7909801
## sample estimates:
##      cor 
## 0.703926</code></pre>
<p>In these three examples, we see that the <span class="math inline">\(p\)</span>-values are all statistically
significant at <span class="math inline">\(\alpha = 0.05\)</span>. If we look at the test statistic <span class="math inline">\(T\)</span>, we see
that both sample size <span class="math inline">\(n\)</span> and the estimate <span class="math inline">\(r\)</span> affect the test statistic. We
see that larger sample sizes and larger estimates of <span class="math inline">\(\rho\)</span> result in a larger
test statistic.</p>
<p>In the following example, we keep the random part of the relationship relatively
small. So we are drawing from a population with a strong negative linear
relationship. We will use varying sample sizes (from small to large).</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="relationships-and-regression.html#cb34-1" tabindex="-1"></a><span class="co"># Create a sample dataset</span></span>
<span id="cb34-2"><a href="relationships-and-regression.html#cb34-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb34-3"><a href="relationships-and-regression.html#cb34-3" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">X =</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">20</span>, <span class="at">max =</span> <span class="dv">40</span>))</span>
<span id="cb34-4"><a href="relationships-and-regression.html#cb34-4" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">add_column</span>(dat, <span class="at">Y1 =</span> <span class="sc">-</span><span class="dv">5</span> <span class="sc">-</span> <span class="dv">5</span><span class="sc">*</span>dat<span class="sc">$</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="relationships-and-regression.html#cb35-1" tabindex="-1"></a><span class="co"># Visualize the relationships</span></span>
<span id="cb35-2"><a href="relationships-and-regression.html#cb35-2" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> X)) <span class="sc">+</span></span>
<span id="cb35-3"><a href="relationships-and-regression.html#cb35-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y1), <span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-4"><a href="relationships-and-regression.html#cb35-4" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">slope =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-5"><a href="relationships-and-regression.html#cb35-5" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="relationships-and-regression.html#cb36-1" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="at">x =</span> dat<span class="sc">$</span>X, <span class="at">y =</span> dat<span class="sc">$</span>Y1, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  dat$X and dat$Y1
## t = -120.08, df = 1, p-value = 0.005301
## alternative hypothesis: true correlation is not equal to 0
## sample estimates:
##        cor 
## -0.9999653</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="relationships-and-regression.html#cb38-1" tabindex="-1"></a><span class="co"># Create a sample dataset</span></span>
<span id="cb38-2"><a href="relationships-and-regression.html#cb38-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb38-3"><a href="relationships-and-regression.html#cb38-3" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">X =</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">20</span>, <span class="at">max =</span> <span class="dv">40</span>))</span>
<span id="cb38-4"><a href="relationships-and-regression.html#cb38-4" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">add_column</span>(dat, <span class="at">Y1 =</span> <span class="sc">-</span><span class="dv">5</span> <span class="sc">-</span> <span class="dv">5</span><span class="sc">*</span>dat<span class="sc">$</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="relationships-and-regression.html#cb39-1" tabindex="-1"></a><span class="co"># Visualize the relationships</span></span>
<span id="cb39-2"><a href="relationships-and-regression.html#cb39-2" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> X)) <span class="sc">+</span></span>
<span id="cb39-3"><a href="relationships-and-regression.html#cb39-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y1), <span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-4"><a href="relationships-and-regression.html#cb39-4" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">slope =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-5"><a href="relationships-and-regression.html#cb39-5" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="relationships-and-regression.html#cb40-1" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="at">x =</span> dat<span class="sc">$</span>X, <span class="at">y =</span> dat<span class="sc">$</span>Y1, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  dat$X and dat$Y1
## t = -136.97, df = 28, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.9996494 -0.9984158
## sample estimates:
##        cor 
## -0.9992546</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="relationships-and-regression.html#cb42-1" tabindex="-1"></a><span class="co"># Create a sample dataset</span></span>
<span id="cb42-2"><a href="relationships-and-regression.html#cb42-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb42-3"><a href="relationships-and-regression.html#cb42-3" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">X =</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">20</span>, <span class="at">max =</span> <span class="dv">40</span>))</span>
<span id="cb42-4"><a href="relationships-and-regression.html#cb42-4" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">add_column</span>(dat, <span class="at">Y1 =</span> <span class="sc">-</span><span class="dv">5</span> <span class="sc">-</span> <span class="dv">5</span><span class="sc">*</span>dat<span class="sc">$</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="relationships-and-regression.html#cb43-1" tabindex="-1"></a><span class="co"># Visualize the relationships</span></span>
<span id="cb43-2"><a href="relationships-and-regression.html#cb43-2" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> X)) <span class="sc">+</span></span>
<span id="cb43-3"><a href="relationships-and-regression.html#cb43-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y1), <span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-4"><a href="relationships-and-regression.html#cb43-4" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">slope =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-5"><a href="relationships-and-regression.html#cb43-5" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="relationships-and-regression.html#cb44-1" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="at">x =</span> dat<span class="sc">$</span>X, <span class="at">y =</span> dat<span class="sc">$</span>Y1, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  dat$X and dat$Y1
## t = -236.6, df = 48, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.9997581 -0.9992411
## sample estimates:
##        cor 
## -0.9995715</code></pre>
<p>We will now increae the variability around the regression line of the linear
relationship.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="relationships-and-regression.html#cb46-1" tabindex="-1"></a><span class="co"># Create a sample dataset</span></span>
<span id="cb46-2"><a href="relationships-and-regression.html#cb46-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb46-3"><a href="relationships-and-regression.html#cb46-3" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">X =</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">20</span>, <span class="at">max =</span> <span class="dv">40</span>))</span>
<span id="cb46-4"><a href="relationships-and-regression.html#cb46-4" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">add_column</span>(dat, <span class="at">Y1 =</span> <span class="sc">-</span><span class="dv">5</span> <span class="sc">-</span> <span class="dv">5</span><span class="sc">*</span>dat<span class="sc">$</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">30</span>))</span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="relationships-and-regression.html#cb47-1" tabindex="-1"></a><span class="co"># Visualize the relationships</span></span>
<span id="cb47-2"><a href="relationships-and-regression.html#cb47-2" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> X)) <span class="sc">+</span></span>
<span id="cb47-3"><a href="relationships-and-regression.html#cb47-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y1), <span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb47-4"><a href="relationships-and-regression.html#cb47-4" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">slope =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb47-5"><a href="relationships-and-regression.html#cb47-5" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="relationships-and-regression.html#cb48-1" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="at">x =</span> dat<span class="sc">$</span>X, <span class="at">y =</span> dat<span class="sc">$</span>Y1, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  dat$X and dat$Y1
## t = -3.9069, df = 1, p-value = 0.1595
## alternative hypothesis: true correlation is not equal to 0
## sample estimates:
##        cor 
## -0.9687692</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="relationships-and-regression.html#cb50-1" tabindex="-1"></a><span class="co"># Create a sample dataset</span></span>
<span id="cb50-2"><a href="relationships-and-regression.html#cb50-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb50-3"><a href="relationships-and-regression.html#cb50-3" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">X =</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">20</span>, <span class="at">max =</span> <span class="dv">40</span>))</span>
<span id="cb50-4"><a href="relationships-and-regression.html#cb50-4" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">add_column</span>(dat, <span class="at">Y1 =</span> <span class="sc">-</span><span class="dv">5</span> <span class="sc">-</span> <span class="dv">5</span><span class="sc">*</span>dat<span class="sc">$</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">30</span>))</span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="relationships-and-regression.html#cb51-1" tabindex="-1"></a><span class="co"># Visualize the relationships</span></span>
<span id="cb51-2"><a href="relationships-and-regression.html#cb51-2" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> X)) <span class="sc">+</span></span>
<span id="cb51-3"><a href="relationships-and-regression.html#cb51-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y1), <span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-4"><a href="relationships-and-regression.html#cb51-4" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">slope =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-5"><a href="relationships-and-regression.html#cb51-5" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="relationships-and-regression.html#cb52-1" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="at">x =</span> dat<span class="sc">$</span>X, <span class="at">y =</span> dat<span class="sc">$</span>Y1, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  dat$X and dat$Y1
## t = -4.5246, df = 28, p-value = 0.0001016
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.8185127 -0.3781540
## sample estimates:
##        cor 
## -0.6498847</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="relationships-and-regression.html#cb54-1" tabindex="-1"></a><span class="co"># Create a sample dataset</span></span>
<span id="cb54-2"><a href="relationships-and-regression.html#cb54-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb54-3"><a href="relationships-and-regression.html#cb54-3" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">X =</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">20</span>, <span class="at">max =</span> <span class="dv">40</span>))</span>
<span id="cb54-4"><a href="relationships-and-regression.html#cb54-4" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">add_column</span>(dat, <span class="at">Y1 =</span> <span class="sc">-</span><span class="dv">5</span> <span class="sc">-</span> <span class="dv">5</span><span class="sc">*</span>dat<span class="sc">$</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">30</span>))</span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="relationships-and-regression.html#cb55-1" tabindex="-1"></a><span class="co"># Visualize the relationships</span></span>
<span id="cb55-2"><a href="relationships-and-regression.html#cb55-2" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> X)) <span class="sc">+</span></span>
<span id="cb55-3"><a href="relationships-and-regression.html#cb55-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y1), <span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb55-4"><a href="relationships-and-regression.html#cb55-4" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">slope =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb55-5"><a href="relationships-and-regression.html#cb55-5" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="relationships-and-regression.html#cb56-1" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="at">x =</span> dat<span class="sc">$</span>X, <span class="at">y =</span> dat<span class="sc">$</span>Y1, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  dat$X and dat$Y1
## t = -7.2289, df = 48, p-value = 3.281e-09
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.8329269 -0.5551802
## sample estimates:
##       cor 
## -0.721961</code></pre>
</div>
<div id="no-relationship" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> No Relationship<a href="relationships-and-regression.html#no-relationship" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Assume there is no relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, then the true Pearson
correlation coefficient <span class="math inline">\(\rho = 0\)</span>. Therefore, the null hypothesis should not
be rejected.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="relationships-and-regression.html#cb58-1" tabindex="-1"></a><span class="co"># Create a sample dataset</span></span>
<span id="cb58-2"><a href="relationships-and-regression.html#cb58-2" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">X =</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="at">min =</span> <span class="dv">20</span>, <span class="at">max =</span> <span class="dv">40</span>), <span class="at">Y =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="relationships-and-regression.html#cb59-1" tabindex="-1"></a><span class="co"># Visualize the relationships</span></span>
<span id="cb59-2"><a href="relationships-and-regression.html#cb59-2" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb59-3"><a href="relationships-and-regression.html#cb59-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb59-4"><a href="relationships-and-regression.html#cb59-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;y ~ x&quot;</span>, <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb59-5"><a href="relationships-and-regression.html#cb59-5" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="relationships-and-regression.html#cb60-1" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="at">x =</span> dat<span class="sc">$</span>X, <span class="at">y =</span> dat<span class="sc">$</span>Y, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  dat$X and dat$Y
## t = -0.51726, df = 98, p-value = 0.6061
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.2460756  0.1457322
## sample estimates:
##         cor 
## -0.05217951</code></pre>
<p>Another example.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="relationships-and-regression.html#cb62-1" tabindex="-1"></a><span class="co"># Create a sample dataset</span></span>
<span id="cb62-2"><a href="relationships-and-regression.html#cb62-2" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">X =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="at">Y =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>))</span></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="relationships-and-regression.html#cb63-1" tabindex="-1"></a><span class="co"># Visualize the relationships</span></span>
<span id="cb63-2"><a href="relationships-and-regression.html#cb63-2" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb63-3"><a href="relationships-and-regression.html#cb63-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb63-4"><a href="relationships-and-regression.html#cb63-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;y ~ x&quot;</span>, <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb63-5"><a href="relationships-and-regression.html#cb63-5" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="relationships-and-regression.html#cb64-1" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="at">x =</span> dat<span class="sc">$</span>X, <span class="at">y =</span> dat<span class="sc">$</span>Y, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  dat$X and dat$Y
## t = 0.94208, df = 98, p-value = 0.3485
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.1036095  0.2858359
## sample estimates:
##        cor 
## 0.09473661</code></pre>
</div>
<div id="orange-dataset" class="section level3 hasAnchor" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> Orange Dataset<a href="relationships-and-regression.html#orange-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If we go back to our case study from the trees dataset.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="relationships-and-regression.html#cb66-1" tabindex="-1"></a><span class="fu">ggplot</span>(Orange, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> circumference)) <span class="sc">+</span></span>
<span id="cb66-2"><a href="relationships-and-regression.html#cb66-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb66-3"><a href="relationships-and-regression.html#cb66-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;y ~ x&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb66-4"><a href="relationships-and-regression.html#cb66-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Age (days)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Circumference (mm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb66-5"><a href="relationships-and-regression.html#cb66-5" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<p>We already described this relationship. We can now calculate the Pearson
correlation coefficient manually. First, we must calculate the covariance. Let
the random variable <span class="math inline">\(X\)</span> denote the age and <span class="math inline">\(Y\)</span> the circumference.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="relationships-and-regression.html#cb67-1" tabindex="-1"></a><span class="co"># Calculate the quantities required to calculate the covariance</span></span>
<span id="cb67-2"><a href="relationships-and-regression.html#cb67-2" tabindex="-1"></a>orange_rel <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(Orange) <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="relationships-and-regression.html#cb67-3" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">X =</span> age, <span class="at">Y =</span> circumference) <span class="sc">%&gt;%</span></span>
<span id="cb67-4"><a href="relationships-and-regression.html#cb67-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">X_bar =</span> <span class="fu">mean</span>(X), <span class="at">Y_bar =</span> <span class="fu">mean</span>(Y)) <span class="sc">%&gt;%</span></span>
<span id="cb67-5"><a href="relationships-and-regression.html#cb67-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">X_minus_X_bar =</span> X <span class="sc">-</span> X_bar, <span class="at">Y_minus_Y_bar =</span> Y <span class="sc">-</span> Y_bar) <span class="sc">%&gt;%</span></span>
<span id="cb67-6"><a href="relationships-and-regression.html#cb67-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cross_product =</span> X_minus_X_bar <span class="sc">*</span> Y_minus_Y_bar)</span>
<span id="cb67-7"><a href="relationships-and-regression.html#cb67-7" tabindex="-1"></a></span>
<span id="cb67-8"><a href="relationships-and-regression.html#cb67-8" tabindex="-1"></a><span class="fu">kable</span>(orange_rel)</span></code></pre></div>
<table>
<colgroup>
<col width="7%" />
<col width="5%" />
<col width="13%" />
<col width="13%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">X</th>
<th align="right">Y</th>
<th align="right">X_bar</th>
<th align="right">Y_bar</th>
<th align="right">X_minus_X_bar</th>
<th align="right">Y_minus_Y_bar</th>
<th align="right">cross_product</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">118</td>
<td align="right">30</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">-804.14286</td>
<td align="right">-85.8571429</td>
<td align="right">69041.40816</td>
</tr>
<tr class="even">
<td align="right">484</td>
<td align="right">58</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">-438.14286</td>
<td align="right">-57.8571429</td>
<td align="right">25349.69388</td>
</tr>
<tr class="odd">
<td align="right">664</td>
<td align="right">87</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">-258.14286</td>
<td align="right">-28.8571429</td>
<td align="right">7449.26531</td>
</tr>
<tr class="even">
<td align="right">1004</td>
<td align="right">115</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">81.85714</td>
<td align="right">-0.8571429</td>
<td align="right">-70.16327</td>
</tr>
<tr class="odd">
<td align="right">1231</td>
<td align="right">120</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">308.85714</td>
<td align="right">4.1428571</td>
<td align="right">1279.55102</td>
</tr>
<tr class="even">
<td align="right">1372</td>
<td align="right">142</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">449.85714</td>
<td align="right">26.1428571</td>
<td align="right">11760.55102</td>
</tr>
<tr class="odd">
<td align="right">1582</td>
<td align="right">145</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">659.85714</td>
<td align="right">29.1428571</td>
<td align="right">19230.12245</td>
</tr>
<tr class="even">
<td align="right">118</td>
<td align="right">33</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">-804.14286</td>
<td align="right">-82.8571429</td>
<td align="right">66628.97959</td>
</tr>
<tr class="odd">
<td align="right">484</td>
<td align="right">69</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">-438.14286</td>
<td align="right">-46.8571429</td>
<td align="right">20530.12245</td>
</tr>
<tr class="even">
<td align="right">664</td>
<td align="right">111</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">-258.14286</td>
<td align="right">-4.8571429</td>
<td align="right">1253.83673</td>
</tr>
<tr class="odd">
<td align="right">1004</td>
<td align="right">156</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">81.85714</td>
<td align="right">40.1428571</td>
<td align="right">3285.97959</td>
</tr>
<tr class="even">
<td align="right">1231</td>
<td align="right">172</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">308.85714</td>
<td align="right">56.1428571</td>
<td align="right">17340.12245</td>
</tr>
<tr class="odd">
<td align="right">1372</td>
<td align="right">203</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">449.85714</td>
<td align="right">87.1428571</td>
<td align="right">39201.83673</td>
</tr>
<tr class="even">
<td align="right">1582</td>
<td align="right">203</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">659.85714</td>
<td align="right">87.1428571</td>
<td align="right">57501.83673</td>
</tr>
<tr class="odd">
<td align="right">118</td>
<td align="right">30</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">-804.14286</td>
<td align="right">-85.8571429</td>
<td align="right">69041.40816</td>
</tr>
<tr class="even">
<td align="right">484</td>
<td align="right">51</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">-438.14286</td>
<td align="right">-64.8571429</td>
<td align="right">28416.69388</td>
</tr>
<tr class="odd">
<td align="right">664</td>
<td align="right">75</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">-258.14286</td>
<td align="right">-40.8571429</td>
<td align="right">10546.97959</td>
</tr>
<tr class="even">
<td align="right">1004</td>
<td align="right">108</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">81.85714</td>
<td align="right">-7.8571429</td>
<td align="right">-643.16327</td>
</tr>
<tr class="odd">
<td align="right">1231</td>
<td align="right">115</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">308.85714</td>
<td align="right">-0.8571429</td>
<td align="right">-264.73469</td>
</tr>
<tr class="even">
<td align="right">1372</td>
<td align="right">139</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">449.85714</td>
<td align="right">23.1428571</td>
<td align="right">10410.97959</td>
</tr>
<tr class="odd">
<td align="right">1582</td>
<td align="right">140</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">659.85714</td>
<td align="right">24.1428571</td>
<td align="right">15930.83673</td>
</tr>
<tr class="even">
<td align="right">118</td>
<td align="right">32</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">-804.14286</td>
<td align="right">-83.8571429</td>
<td align="right">67433.12245</td>
</tr>
<tr class="odd">
<td align="right">484</td>
<td align="right">62</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">-438.14286</td>
<td align="right">-53.8571429</td>
<td align="right">23597.12245</td>
</tr>
<tr class="even">
<td align="right">664</td>
<td align="right">112</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">-258.14286</td>
<td align="right">-3.8571429</td>
<td align="right">995.69388</td>
</tr>
<tr class="odd">
<td align="right">1004</td>
<td align="right">167</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">81.85714</td>
<td align="right">51.1428571</td>
<td align="right">4186.40816</td>
</tr>
<tr class="even">
<td align="right">1231</td>
<td align="right">179</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">308.85714</td>
<td align="right">63.1428571</td>
<td align="right">19502.12245</td>
</tr>
<tr class="odd">
<td align="right">1372</td>
<td align="right">209</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">449.85714</td>
<td align="right">93.1428571</td>
<td align="right">41900.97959</td>
</tr>
<tr class="even">
<td align="right">1582</td>
<td align="right">214</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">659.85714</td>
<td align="right">98.1428571</td>
<td align="right">64760.26531</td>
</tr>
<tr class="odd">
<td align="right">118</td>
<td align="right">30</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">-804.14286</td>
<td align="right">-85.8571429</td>
<td align="right">69041.40816</td>
</tr>
<tr class="even">
<td align="right">484</td>
<td align="right">49</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">-438.14286</td>
<td align="right">-66.8571429</td>
<td align="right">29292.97959</td>
</tr>
<tr class="odd">
<td align="right">664</td>
<td align="right">81</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">-258.14286</td>
<td align="right">-34.8571429</td>
<td align="right">8998.12245</td>
</tr>
<tr class="even">
<td align="right">1004</td>
<td align="right">125</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">81.85714</td>
<td align="right">9.1428571</td>
<td align="right">748.40816</td>
</tr>
<tr class="odd">
<td align="right">1231</td>
<td align="right">142</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">308.85714</td>
<td align="right">26.1428571</td>
<td align="right">8074.40816</td>
</tr>
<tr class="even">
<td align="right">1372</td>
<td align="right">174</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">449.85714</td>
<td align="right">58.1428571</td>
<td align="right">26155.97959</td>
</tr>
<tr class="odd">
<td align="right">1582</td>
<td align="right">177</td>
<td align="right">922.1429</td>
<td align="right">115.8571</td>
<td align="right">659.85714</td>
<td align="right">61.1428571</td>
<td align="right">40345.55102</td>
</tr>
</tbody>
</table>
<p>We can now calculate the covariance as follows:</p>
<p><span class="math display">\[
Cov(X, Y) = \frac{\sum_{i = 1}^{n} (X_i - \overline{X})(Y_i - \overline{Y})}{n - 1}
\]</span></p>
<p>Which gives us:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="relationships-and-regression.html#cb68-1" tabindex="-1"></a><span class="fu">sum</span>(orange_rel<span class="sc">$</span>cross_product) <span class="sc">/</span> (<span class="fu">nrow</span>(orange_rel) <span class="sc">-</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 25831.02</code></pre>
<p>or:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="relationships-and-regression.html#cb70-1" tabindex="-1"></a><span class="fu">cov</span>(orange_rel<span class="sc">$</span>X, orange_rel<span class="sc">$</span>Y)</span></code></pre></div>
<pre><code>## [1] 25831.02</code></pre>
<p>We can now divide the covariance between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> by the product of the
sample standard deviations of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="relationships-and-regression.html#cb72-1" tabindex="-1"></a>(<span class="fu">sum</span>(orange_rel<span class="sc">$</span>cross_product) <span class="sc">/</span> (<span class="fu">nrow</span>(orange_rel) <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">/</span> </span>
<span id="cb72-2"><a href="relationships-and-regression.html#cb72-2" tabindex="-1"></a>  (<span class="fu">sd</span>(orange_rel<span class="sc">$</span>X) <span class="sc">*</span> <span class="fu">sd</span>(orange_rel<span class="sc">$</span>Y))</span></code></pre></div>
<pre><code>## [1] 0.9135189</code></pre>
<p>or:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="relationships-and-regression.html#cb74-1" tabindex="-1"></a><span class="fu">cor</span>(<span class="at">x =</span> orange_rel<span class="sc">$</span>X, <span class="at">y =</span> orange_rel<span class="sc">$</span>Y, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 0.9135189</code></pre>
<p>Before interpreting the estimate of the Pearson correlation coefficient, we can
perform a hypothesis test to check if it differs from 0 at a significance level
of <span class="math inline">\(\alpha = 0.05\)</span>. The null and alternative hypotheses state:</p>
<p><span class="math display">\[
H_0 : \rho = 0 \text{ vs. } H_a : \rho \neq 0
\]</span></p>
<p>We perform the hypothesis test:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="relationships-and-regression.html#cb76-1" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="at">x =</span> Orange<span class="sc">$</span>age, <span class="at">y =</span> Orange<span class="sc">$</span>circumference, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  Orange$age and Orange$circumference
## t = 12.9, df = 33, p-value = 1.931e-14
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.8342364 0.9557955
## sample estimates:
##       cor 
## 0.9135189</code></pre>
<p>To conclude, we can state that the visualization of the observations and a
LOESS curve indicate a positive linear relationship between age and
circumference of trees. The Pearson correlation coefficient estimate of
<span class="math inline">\(r = 0.9135189\)</span> (<span class="math inline">\(p &lt; 0.0001\)</span>) indicates a very strong positive linear relation
between age and circumference.</p>
</div>
</div>
<div id="spearman-rank-correlation" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Spearman Rank Correlation<a href="relationships-and-regression.html#spearman-rank-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Spearman rank correlation coefficient can be used for ordinal or rank-ordered
data. To calculate the Spearman correlation for variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, we first
must obtain the rank for every value per variable. For this, we order the values
from large to small and assign a rank to each value.</p>
<p>Let the random variable <span class="math inline">\(X\)</span> denote the age in days and <span class="math inline">\(Y\)</span> denote the
circumference in millimeters. Let <span class="math inline">\(R_{xi}\)</span> denote the rank for the observed
value <span class="math inline">\(x_i\)</span> and <span class="math inline">\(R_{yi}\)</span> the rank for the observed value <span class="math inline">\(y_i\)</span>.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="relationships-and-regression.html#cb78-1" tabindex="-1"></a>orange_spm <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(Orange) <span class="sc">%&gt;%</span></span>
<span id="cb78-2"><a href="relationships-and-regression.html#cb78-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">X =</span> age, <span class="at">Y =</span> circumference) <span class="sc">%&gt;%</span></span>
<span id="cb78-3"><a href="relationships-and-regression.html#cb78-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">X_rank =</span> <span class="fu">rank</span>(X), <span class="at">Y_rank =</span> <span class="fu">rank</span>(Y))</span>
<span id="cb78-4"><a href="relationships-and-regression.html#cb78-4" tabindex="-1"></a></span>
<span id="cb78-5"><a href="relationships-and-regression.html#cb78-5" tabindex="-1"></a><span class="fu">kable</span>(orange_spm)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">X</th>
<th align="right">Y</th>
<th align="right">X_rank</th>
<th align="right">Y_rank</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">118</td>
<td align="right">30</td>
<td align="right">3</td>
<td align="right">2.0</td>
</tr>
<tr class="even">
<td align="right">484</td>
<td align="right">58</td>
<td align="right">8</td>
<td align="right">8.0</td>
</tr>
<tr class="odd">
<td align="right">664</td>
<td align="right">87</td>
<td align="right">13</td>
<td align="right">13.0</td>
</tr>
<tr class="even">
<td align="right">1004</td>
<td align="right">115</td>
<td align="right">18</td>
<td align="right">17.5</td>
</tr>
<tr class="odd">
<td align="right">1231</td>
<td align="right">120</td>
<td align="right">23</td>
<td align="right">19.0</td>
</tr>
<tr class="even">
<td align="right">1372</td>
<td align="right">142</td>
<td align="right">28</td>
<td align="right">23.5</td>
</tr>
<tr class="odd">
<td align="right">1582</td>
<td align="right">145</td>
<td align="right">33</td>
<td align="right">25.0</td>
</tr>
<tr class="even">
<td align="right">118</td>
<td align="right">33</td>
<td align="right">3</td>
<td align="right">5.0</td>
</tr>
<tr class="odd">
<td align="right">484</td>
<td align="right">69</td>
<td align="right">8</td>
<td align="right">10.0</td>
</tr>
<tr class="even">
<td align="right">664</td>
<td align="right">111</td>
<td align="right">13</td>
<td align="right">15.0</td>
</tr>
<tr class="odd">
<td align="right">1004</td>
<td align="right">156</td>
<td align="right">18</td>
<td align="right">26.0</td>
</tr>
<tr class="even">
<td align="right">1231</td>
<td align="right">172</td>
<td align="right">23</td>
<td align="right">28.0</td>
</tr>
<tr class="odd">
<td align="right">1372</td>
<td align="right">203</td>
<td align="right">28</td>
<td align="right">32.5</td>
</tr>
<tr class="even">
<td align="right">1582</td>
<td align="right">203</td>
<td align="right">33</td>
<td align="right">32.5</td>
</tr>
<tr class="odd">
<td align="right">118</td>
<td align="right">30</td>
<td align="right">3</td>
<td align="right">2.0</td>
</tr>
<tr class="even">
<td align="right">484</td>
<td align="right">51</td>
<td align="right">8</td>
<td align="right">7.0</td>
</tr>
<tr class="odd">
<td align="right">664</td>
<td align="right">75</td>
<td align="right">13</td>
<td align="right">11.0</td>
</tr>
<tr class="even">
<td align="right">1004</td>
<td align="right">108</td>
<td align="right">18</td>
<td align="right">14.0</td>
</tr>
<tr class="odd">
<td align="right">1231</td>
<td align="right">115</td>
<td align="right">23</td>
<td align="right">17.5</td>
</tr>
<tr class="even">
<td align="right">1372</td>
<td align="right">139</td>
<td align="right">28</td>
<td align="right">21.0</td>
</tr>
<tr class="odd">
<td align="right">1582</td>
<td align="right">140</td>
<td align="right">33</td>
<td align="right">22.0</td>
</tr>
<tr class="even">
<td align="right">118</td>
<td align="right">32</td>
<td align="right">3</td>
<td align="right">4.0</td>
</tr>
<tr class="odd">
<td align="right">484</td>
<td align="right">62</td>
<td align="right">8</td>
<td align="right">9.0</td>
</tr>
<tr class="even">
<td align="right">664</td>
<td align="right">112</td>
<td align="right">13</td>
<td align="right">16.0</td>
</tr>
<tr class="odd">
<td align="right">1004</td>
<td align="right">167</td>
<td align="right">18</td>
<td align="right">27.0</td>
</tr>
<tr class="even">
<td align="right">1231</td>
<td align="right">179</td>
<td align="right">23</td>
<td align="right">31.0</td>
</tr>
<tr class="odd">
<td align="right">1372</td>
<td align="right">209</td>
<td align="right">28</td>
<td align="right">34.0</td>
</tr>
<tr class="even">
<td align="right">1582</td>
<td align="right">214</td>
<td align="right">33</td>
<td align="right">35.0</td>
</tr>
<tr class="odd">
<td align="right">118</td>
<td align="right">30</td>
<td align="right">3</td>
<td align="right">2.0</td>
</tr>
<tr class="even">
<td align="right">484</td>
<td align="right">49</td>
<td align="right">8</td>
<td align="right">6.0</td>
</tr>
<tr class="odd">
<td align="right">664</td>
<td align="right">81</td>
<td align="right">13</td>
<td align="right">12.0</td>
</tr>
<tr class="even">
<td align="right">1004</td>
<td align="right">125</td>
<td align="right">18</td>
<td align="right">20.0</td>
</tr>
<tr class="odd">
<td align="right">1231</td>
<td align="right">142</td>
<td align="right">23</td>
<td align="right">23.5</td>
</tr>
<tr class="even">
<td align="right">1372</td>
<td align="right">174</td>
<td align="right">28</td>
<td align="right">29.0</td>
</tr>
<tr class="odd">
<td align="right">1582</td>
<td align="right">177</td>
<td align="right">33</td>
<td align="right">30.0</td>
</tr>
</tbody>
</table>
<p>With the ranks, we can then calculate the difference in ranks for every
observation as follows:</p>
<p><span class="math display">\[
d_i = R_{xi} - R_{yi}
\]</span></p>
<p>Subsequently, we can calculate the sample Spearman correlation:</p>
<p><span class="math display">\[
r_s = 1 - \frac{6 \sum_{i = 1}^{n} d_{i}^{2}}{n(n^2 - 1)}
\]</span></p>
<p>We can perform a hypothesis test with the following null and alternative
hypotheses:</p>
<p><span class="math display">\[
H_0 : \rho = 0 \text{ vs. } H_a : \rho \neq 0
\]</span></p>
<p>Under the null hypothesis and if the sample size is large enough (<span class="math inline">\(n \geq 10\)</span>),
the Spearman rank correlation coefficient is approximately normally distributed
with <span class="math inline">\(\mu_{r_s} = 0\)</span> and <span class="math inline">\(\sigma_{r_s} = \sqrt{\frac{1}{n - 1}}\)</span>. Using this,
we can calculate the test statistic <span class="math inline">\(T\)</span>:</p>
<p><span class="math display">\[
T = \frac{r_s - \mu_{r_s}}{\sigma_{r_s}}
\]</span></p>
<p>We can continue with the <strong>Orange</strong> dataset:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="relationships-and-regression.html#cb79-1" tabindex="-1"></a>orange_spm <span class="ot">&lt;-</span> orange_spm <span class="sc">%&gt;%</span></span>
<span id="cb79-2"><a href="relationships-and-regression.html#cb79-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">delta =</span> X_rank <span class="sc">-</span> Y_rank, <span class="at">delta_2 =</span> delta<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb79-3"><a href="relationships-and-regression.html#cb79-3" tabindex="-1"></a></span>
<span id="cb79-4"><a href="relationships-and-regression.html#cb79-4" tabindex="-1"></a><span class="fu">kable</span>(orange_spm)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">X</th>
<th align="right">Y</th>
<th align="right">X_rank</th>
<th align="right">Y_rank</th>
<th align="right">delta</th>
<th align="right">delta_2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">118</td>
<td align="right">30</td>
<td align="right">3</td>
<td align="right">2.0</td>
<td align="right">1.0</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="right">484</td>
<td align="right">58</td>
<td align="right">8</td>
<td align="right">8.0</td>
<td align="right">0.0</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="right">664</td>
<td align="right">87</td>
<td align="right">13</td>
<td align="right">13.0</td>
<td align="right">0.0</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="right">1004</td>
<td align="right">115</td>
<td align="right">18</td>
<td align="right">17.5</td>
<td align="right">0.5</td>
<td align="right">0.25</td>
</tr>
<tr class="odd">
<td align="right">1231</td>
<td align="right">120</td>
<td align="right">23</td>
<td align="right">19.0</td>
<td align="right">4.0</td>
<td align="right">16.00</td>
</tr>
<tr class="even">
<td align="right">1372</td>
<td align="right">142</td>
<td align="right">28</td>
<td align="right">23.5</td>
<td align="right">4.5</td>
<td align="right">20.25</td>
</tr>
<tr class="odd">
<td align="right">1582</td>
<td align="right">145</td>
<td align="right">33</td>
<td align="right">25.0</td>
<td align="right">8.0</td>
<td align="right">64.00</td>
</tr>
<tr class="even">
<td align="right">118</td>
<td align="right">33</td>
<td align="right">3</td>
<td align="right">5.0</td>
<td align="right">-2.0</td>
<td align="right">4.00</td>
</tr>
<tr class="odd">
<td align="right">484</td>
<td align="right">69</td>
<td align="right">8</td>
<td align="right">10.0</td>
<td align="right">-2.0</td>
<td align="right">4.00</td>
</tr>
<tr class="even">
<td align="right">664</td>
<td align="right">111</td>
<td align="right">13</td>
<td align="right">15.0</td>
<td align="right">-2.0</td>
<td align="right">4.00</td>
</tr>
<tr class="odd">
<td align="right">1004</td>
<td align="right">156</td>
<td align="right">18</td>
<td align="right">26.0</td>
<td align="right">-8.0</td>
<td align="right">64.00</td>
</tr>
<tr class="even">
<td align="right">1231</td>
<td align="right">172</td>
<td align="right">23</td>
<td align="right">28.0</td>
<td align="right">-5.0</td>
<td align="right">25.00</td>
</tr>
<tr class="odd">
<td align="right">1372</td>
<td align="right">203</td>
<td align="right">28</td>
<td align="right">32.5</td>
<td align="right">-4.5</td>
<td align="right">20.25</td>
</tr>
<tr class="even">
<td align="right">1582</td>
<td align="right">203</td>
<td align="right">33</td>
<td align="right">32.5</td>
<td align="right">0.5</td>
<td align="right">0.25</td>
</tr>
<tr class="odd">
<td align="right">118</td>
<td align="right">30</td>
<td align="right">3</td>
<td align="right">2.0</td>
<td align="right">1.0</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="right">484</td>
<td align="right">51</td>
<td align="right">8</td>
<td align="right">7.0</td>
<td align="right">1.0</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="right">664</td>
<td align="right">75</td>
<td align="right">13</td>
<td align="right">11.0</td>
<td align="right">2.0</td>
<td align="right">4.00</td>
</tr>
<tr class="even">
<td align="right">1004</td>
<td align="right">108</td>
<td align="right">18</td>
<td align="right">14.0</td>
<td align="right">4.0</td>
<td align="right">16.00</td>
</tr>
<tr class="odd">
<td align="right">1231</td>
<td align="right">115</td>
<td align="right">23</td>
<td align="right">17.5</td>
<td align="right">5.5</td>
<td align="right">30.25</td>
</tr>
<tr class="even">
<td align="right">1372</td>
<td align="right">139</td>
<td align="right">28</td>
<td align="right">21.0</td>
<td align="right">7.0</td>
<td align="right">49.00</td>
</tr>
<tr class="odd">
<td align="right">1582</td>
<td align="right">140</td>
<td align="right">33</td>
<td align="right">22.0</td>
<td align="right">11.0</td>
<td align="right">121.00</td>
</tr>
<tr class="even">
<td align="right">118</td>
<td align="right">32</td>
<td align="right">3</td>
<td align="right">4.0</td>
<td align="right">-1.0</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="right">484</td>
<td align="right">62</td>
<td align="right">8</td>
<td align="right">9.0</td>
<td align="right">-1.0</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="right">664</td>
<td align="right">112</td>
<td align="right">13</td>
<td align="right">16.0</td>
<td align="right">-3.0</td>
<td align="right">9.00</td>
</tr>
<tr class="odd">
<td align="right">1004</td>
<td align="right">167</td>
<td align="right">18</td>
<td align="right">27.0</td>
<td align="right">-9.0</td>
<td align="right">81.00</td>
</tr>
<tr class="even">
<td align="right">1231</td>
<td align="right">179</td>
<td align="right">23</td>
<td align="right">31.0</td>
<td align="right">-8.0</td>
<td align="right">64.00</td>
</tr>
<tr class="odd">
<td align="right">1372</td>
<td align="right">209</td>
<td align="right">28</td>
<td align="right">34.0</td>
<td align="right">-6.0</td>
<td align="right">36.00</td>
</tr>
<tr class="even">
<td align="right">1582</td>
<td align="right">214</td>
<td align="right">33</td>
<td align="right">35.0</td>
<td align="right">-2.0</td>
<td align="right">4.00</td>
</tr>
<tr class="odd">
<td align="right">118</td>
<td align="right">30</td>
<td align="right">3</td>
<td align="right">2.0</td>
<td align="right">1.0</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="right">484</td>
<td align="right">49</td>
<td align="right">8</td>
<td align="right">6.0</td>
<td align="right">2.0</td>
<td align="right">4.00</td>
</tr>
<tr class="odd">
<td align="right">664</td>
<td align="right">81</td>
<td align="right">13</td>
<td align="right">12.0</td>
<td align="right">1.0</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="right">1004</td>
<td align="right">125</td>
<td align="right">18</td>
<td align="right">20.0</td>
<td align="right">-2.0</td>
<td align="right">4.00</td>
</tr>
<tr class="odd">
<td align="right">1231</td>
<td align="right">142</td>
<td align="right">23</td>
<td align="right">23.5</td>
<td align="right">-0.5</td>
<td align="right">0.25</td>
</tr>
<tr class="even">
<td align="right">1372</td>
<td align="right">174</td>
<td align="right">28</td>
<td align="right">29.0</td>
<td align="right">-1.0</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="right">1582</td>
<td align="right">177</td>
<td align="right">33</td>
<td align="right">30.0</td>
<td align="right">3.0</td>
<td align="right">9.00</td>
</tr>
</tbody>
</table>
<p>We now calculate the sample Spearman rank correlation coefficient:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="relationships-and-regression.html#cb80-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(orange_spm)</span>
<span id="cb80-2"><a href="relationships-and-regression.html#cb80-2" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> ((<span class="dv">6</span> <span class="sc">*</span> <span class="fu">sum</span>(orange_spm<span class="sc">$</span>delta_2)) <span class="sc">/</span> (n <span class="sc">*</span> (n<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## [1] 0.9073529</code></pre>
<p>or:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="relationships-and-regression.html#cb82-1" tabindex="-1"></a><span class="fu">cor</span>(<span class="at">x =</span> orange_spm<span class="sc">$</span>X, <span class="at">y =</span> orange_spm<span class="sc">$</span>Y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 0.9064294</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="missingness.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-relationships-and-regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
